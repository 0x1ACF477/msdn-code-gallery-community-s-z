<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=2030A405196966B152158E82CFDC1CA9" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=7E16F1C82CA446CA06FC9FAEDB0FF887" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Sending Emails with HTML Body in C#</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Sending Emails with HTML Body in C#</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, SMTP, Email Processing in C#, Spire.Email for .NET
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Sending Email Using SMTP, Email C#, Email with Html Body
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">7/16/2017</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/Sending-Emails-with-HTML-76e0a018">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p><span style="font-size:small">This sample presents how to send an email with HTML body using Spire.Email in C#. Spire.Email<span>&nbsp;is a professional .NET Email library specially designed for developers to create, read and manipulate emails from any .NET
 (C#, VB.NET, ASP.NET) platform with fast and high quality performance.&nbsp;</span></span></p>
<p><span style="font-size:small"><strong>Tools we need:</strong></span></p>
<p><span style="font-size:small">- Spire.Email(This dll is available in the package attached.)</span><br>
<span style="font-size:small">- Visual Studio</span></p>
<p><span style="font-size:small; font-weight:bold">Code Snippet:</span></p>
<p><span style="font-size:small; color:#333333; background-color:#ff9900">Step 1: Create an instance of MailMessage class and specify From, To.</span></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">MailAddress addressFrom = new MailAddress(&quot;sender@outlook.com&quot;, &quot;Sender Name&quot;);
MailAddress addressTo = new MailAddress(&quot;recipient@outlook.com&quot;);
MailMessage message = new MailMessage(addressFrom, addressTo);

</pre>
<div class="preview">
<pre class="csharp">MailAddress&nbsp;addressFrom&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;MailAddress(<span class="cs__string">&quot;sender@outlook.com&quot;</span>,&nbsp;<span class="cs__string">&quot;Sender&nbsp;Name&quot;</span>);&nbsp;
MailAddress&nbsp;addressTo&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;MailAddress(<span class="cs__string">&quot;recipient@outlook.com&quot;</span>);&nbsp;
MailMessage&nbsp;message&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;MailMessage(addressFrom,&nbsp;addressTo);&nbsp;
&nbsp;
</pre>
</div>
</div>
</div>
<ul>
</ul>
<p><span style="font-size:small; background-color:#ff9900">Step 2: Specify data, subject and BodyHtml content.</span></p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">message.Date = DateTime.Now;
message.Subject = &quot;Sending Email with HTML Body&quot;;
string htmlString = @&quot;&lt;html&gt;
                      &lt;body&gt;
                      &lt;p&gt;Dear xxxx,&lt;/p&gt;
                      &lt;p&gt;It has been long since we...&lt;/p&gt;
                      &lt;p&gt;Sincerely,&lt;br&gt;Scott&lt;/br&gt;&lt;/p&gt;
                      &lt;/body&gt;
                      &lt;/html&gt;
                     &quot;;   
message.BodyHtml = htmlString;
</pre>
<div class="preview">
<pre class="csharp">message.Date&nbsp;=&nbsp;DateTime.Now;&nbsp;
message.Subject&nbsp;=&nbsp;<span class="cs__string">&quot;Sending&nbsp;Email&nbsp;with&nbsp;HTML&nbsp;Body&quot;</span>;&nbsp;
<span class="cs__keyword">string</span>&nbsp;htmlString&nbsp;=&nbsp;@&quot;&lt;html&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Dear&nbsp;xxxx,&lt;/p&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;It&nbsp;has&nbsp;been&nbsp;<span class="cs__keyword">long</span>&nbsp;since&nbsp;we...&lt;/p&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Sincerely,&lt;br&gt;Scott&lt;/br&gt;&lt;/p&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;;&nbsp;&nbsp;&nbsp;&nbsp;
message.BodyHtml&nbsp;=&nbsp;htmlString;&nbsp;</pre>
</div>
</div>
</div>
<p>&nbsp;</p>
<p><span style="font-size:small; background-color:#ff9900">Step 3: Create a SmtpClient instance with host, port, username and password, and send the email using SendOne medthod.</span></p>
<p><span style="font-size:small; background-color:#ff9900">&nbsp;</span></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">SmtpClient client = new SmtpClient();
client.Host = &quot;smtp.outlook.com&quot;;
client.Port = 587;
client.Username = addressFrom.Address;
client.Password = &quot;password&quot;;
client.ConnectionProtocols = ConnectionProtocols.Ssl;
client.SendOne(message);
Console.WriteLine(&quot;Sent Successfully!&quot;);
</pre>
<div class="preview">
<pre class="js">SmtpClient&nbsp;client&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;SmtpClient();&nbsp;
client.Host&nbsp;=&nbsp;<span class="js__string">&quot;smtp.outlook.com&quot;</span>;&nbsp;
client.Port&nbsp;=&nbsp;<span class="js__num">587</span>;&nbsp;
client.Username&nbsp;=&nbsp;addressFrom.Address;&nbsp;
client.Password&nbsp;=&nbsp;<span class="js__string">&quot;password&quot;</span>;&nbsp;
client.ConnectionProtocols&nbsp;=&nbsp;ConnectionProtocols.Ssl;&nbsp;
client.SendOne(message);&nbsp;
Console.WriteLine(<span class="js__string">&quot;Sent&nbsp;Successfully!&quot;</span>);&nbsp;</pre>
</div>
</div>
</div>
<p>&nbsp;</p>
<h1><span style="color:#000000"><strong><span style="font-size:small">More Information</span></strong></span></h1>
<p><span style="font-size:small">Spire.Email for .NET is a totally independent .NET Email library which doesn't require Microsoft Outlook installed on system.&nbsp;</span><span style="font-size:small">When creating and sending emails, Spire.Email for .NET enables
 developers to create, send and receive emails using SMTP, POP3 MIME and IMAP protocols. Developers could use Spire.Email to add, extract and remove the attachments from the email message. Developers can also manage the folders to arrange the emails, such as
 create new folder, rename folder, get folder information and delete folder.</span></p>
<p><span style="font-size:small"><strong>Related Links:</strong></span></p>
<p><span style="font-size:small"><strong>&nbsp;</strong>Website:&nbsp;<a href="http://www.e-iceblue.com/">http://www.e-iceblue.com/</a></span></p>
<p><span style="font-size:small">Download:&nbsp;<a href="https://code.msdn.microsoft.com/Sending-Emails-with-HTML-76e0a018/https://www.e-iceblue.com/Download/email-for-net.html">Download Spire.Email</a></span></p>
<p><em><br>
</em></p>

</div>


    </div>
</body>
</html>
