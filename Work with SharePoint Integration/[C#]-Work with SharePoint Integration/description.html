<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://uhf.microsoft.com/mscc/statics/mscc-0.3.6.min.css" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=3C7B146E4D24AB77A9D9006DC4F48F98" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=1070D4FA49BFA3C2DA44B1CB75FED7A7" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Work with SharePoint Integration</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Work with SharePoint Integration</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Microsoft Dynamics CRM, Dynamics 365 Customer Engagement
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Microsoft Dynamics CRM SDK
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Cloud, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">11/16/2017</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Work with SharePoint integration</h1>
<p>SharePoint Server integration enables document management capabilities in Microsoft Dynamics 365. There are two aspects to SharePoint Server integration:</p>
<ul class="unordered">
<li>
<p><span class="label">Setting up SharePoint integration</span>. A system administrator sets up a SharePoint Server environment. The Microsoft Dynamics 365 administrator (a user who has the SharePoint Site Collection Administrator role) selects the Microsoft
 Dynamics 365 entities for which to enable the document management feature, and specifies the target SharePoint Server. As part of specifying the target server, the Microsoft Dynamics 365 administrator specifies the SharePoint Server site collection or the
 SharePoint Server site URL by using the <strong>SharePointSite</strong> entity.</p>
</li><li>
<p><span class="label">Creating and managing SharePoint document location records</span>. Microsoft Dynamics 365 users can create and manage SharePoint Server document location records after SharePoint Server integration is enabled. You can create and manage
 SharePoint Server document location records by using the <strong>SharePointDocumentLocation</strong> entity. Microsoft Dynamics 365 also allows for the automatic creation of folders on the server that is running SharePoint Server for entity records under certain
 conditions. However, automatic creation of folders cannot be done through the Microsoft Dynamics 365 SDK.</p>
</li></ul>
<p>The <strong>SharePointIntegration.sln</strong> file contains the following code samples.</p>
<h2>Requirements</h2>
<p>For more information about the requirements for running the sample code provided here, see
<a href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://docs.microsoft.com/en-us/dynamics365/customer-engagement/developer/org-service/use-sample-helper-code">
Use the sample and helper code</a>.</p>
<h2><span>Sample: Enable document management for entities</span></h2>
<p>The following sample shows how to enable document management for entities in Microsoft Dynamics 365. In this sample code, document management is enabled for the
<strong>Contact</strong> entity using the <a href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://docs.microsoft.com/en-us/dotnet/api/microsoft.xrm.sdk.messages.updateentityrequest?view=dynamics-general-ce-9">
UpdateEntityRequest</a> message. By default, the setting for the <strong>Contact</strong> entity isn&rsquo;t enabled in a new installation of Dynamics 365.</p>
<p>Click to see the <a href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/sourcecode?fileId=182202&amp;pathId=958299383">
EnableDocumentManagement.cs</a> sample file.</p>
<p>More information: <a href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://docs.microsoft.com/en-us/dynamics365/customer-engagement/developer/integration-dev/sample-enable-document-management-entities">
Sample: Enable document management for entities</a> and <a class="selected" href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://docs.microsoft.com/en-us/dynamics365/customer-engagement/developer/integration-dev/enable-document-management-entities" tabindex="0">
Enable document management for entities</a> <strong>&nbsp;</strong><em>&nbsp;</em><em><br>
</em></p>
<h2><span>Sample: Create, retrieve, update, and delete a SharePoint location record</span></h2>
<p>The sample shows how to create, retrieve, update, and delete a SharePoint Server document location records.</p>
<p>Click to see the <a href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/sourcecode?fileId=182202&amp;pathId=958299383">
CRUDSharePointLocationRecords.cs</a> sample file.</p>
<p>More information:&nbsp;<a href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://docs.microsoft.com/en-us/dynamics365/customer-engagement/developer/integration-dev/sample-create-retrieve-update-delete-sharepoint-location-record">Sample: Create, retrieve, update, and delete a SharePoint location
 record</a> and <a class="selected" href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://docs.microsoft.com/en-us/dynamics365/customer-engagement/developer/integration-dev/actions-on-sharepoint-location-records" tabindex="0">
Actions on SharePoint location records</a></p>
<h2><span>Sample: Retrieve absolute URL and site collection URL of a location record</span></h2>
<p>This sample shows how to retrieve the absolute URL and the site collection URL of a SharePoint Server location record in Dynamics 365 using the
<a href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://docs.microsoft.com/en-us/dotnet/api/microsoft.crm.sdk.messages.retrieveabsoluteandsitecollectionurlrequest?view=dynamics-general-ce-9">
RetrieveAbsoluteAndSiteCollectionUrlRequest</a> message.</p>
<p>Click to see the <a href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/sourcecode?fileId=182202&amp;pathId=19308438">
RetrieveAbsoluteAndSiteCollectionURLs.cs</a> sample file.</p>
<p>More information: <a href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://docs.microsoft.com/en-us/dynamics365/customer-engagement/developer/integration-dev/sample-retrieve-absolute-url-and-site-collection-url-of-a-location-record">
Sample: Retrieve absolute URL and site collection URL of a location record</a> and
<a href="https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://code.msdn.microsoft.com/Samples-of-Sharepoint-b4fb016f/https://docs.microsoft.com/en-us/dynamics365/customer-engagement/developer/integration-dev/actions-on-sharepoint-location-records#retrieve-absolute-and-site-collection-urls-for-a-location-record">
Actions on SharePoint location records</a></p>

</div>


    </div>
</body>
</html>
