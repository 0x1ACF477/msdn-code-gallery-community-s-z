<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=875F4807220CE6912BAB87167976178B" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=10B55093DA08CEEF26023F25F71F9E5B" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>TableAdapter WHERE IN</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>TableAdapter WHERE IN</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            SQL, SQL Server, TableAdatper
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Data Binding, SQL, TableAdapter
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">4/2/2017</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Description</h1>
<p><span style="font-size:small">This code sample shows how to create an SQL SELECT statement with a WHERE condition that does WHERE IN condition which are not supported using TableAdapter method of returning data to a typed data table. The main reason WHERE
 IN is not supported is that when defining the parameter there are types e.g. string, int, bool but no array type.</span></p>
<p><span style="font-size:small">Let's look at a simple WHERE IN condition</span></p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>SQL</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">mysql</span>
<pre class="hidden">SELECT  CustomerIdentifier ,
        CompanyName ,
        ContactName
FROM    Customers
WHERE CustomerIdentifier = 4</pre>
<div class="preview">
<pre class="js">SELECT&nbsp;&nbsp;CustomerIdentifier&nbsp;,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CompanyName&nbsp;,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ContactName&nbsp;
FROM&nbsp;&nbsp;&nbsp;&nbsp;Customers&nbsp;
WHERE&nbsp;CustomerIdentifier&nbsp;=&nbsp;<span class="js__num">4</span></pre>
</div>
</div>
</div>
<div class="endscriptcode"><span style="font-size:small">The query above works in a TableAdapter because the value in the WHERE can be mapped to an available type e.g.</span></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><span style="font-size:small"><img id="171752" src="description/39.jpg" alt="" width="375" height="433"></span></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><span style="font-size:small">While the following can not be done with a TableAdapter</span></div>
<div class="endscriptcode"><span style="font-size:small">
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>SQL</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">mysql</span>
<pre class="hidden">SELECT  CustomerIdentifier ,
        CompanyName ,
        ContactName
FROM    Customers
WHERE CustomerIdentifier IN (4,30,34)
</pre>
<div class="preview">
<pre class="js">SELECT&nbsp;&nbsp;CustomerIdentifier&nbsp;,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CompanyName&nbsp;,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ContactName&nbsp;
FROM&nbsp;&nbsp;&nbsp;&nbsp;Customers&nbsp;
WHERE&nbsp;CustomerIdentifier&nbsp;IN&nbsp;(<span class="js__num">4</span>,<span class="js__num">30</span>,<span class="js__num">34</span>)&nbsp;
</pre>
</div>
</div>
</div>
<div class="endscriptcode">A way around this is to override the desired SELECT statement that was created in the designer (.xsd file).&nbsp;</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">For our example, we want to get one or more customers by CustomerIdentifier (the primary key) by allowing the user (in this case) to select multiple customers from a data bound ListBox where the ListBox shows the customer name and
 the value member is CustomerIdentifier.</div>
<div class="endscriptcode"><span style="color:#ffffff">.</span></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Jumping passed adding a Data Source to the project we are jumping into creating the SELECT xxx WHERE IN.</div>
<div class="endscriptcode"><span style="color:#ffffff">.</span></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Select the table in the xsd file (here it's Customers), right click on CustomersTableAdapter and select add new query.</div>
<div class="endscriptcode"><img id="171753" src="description/58.jpg" alt="" width="464" height="331"></div>
<div class="endscriptcode">The query here has a WHERE = @InValues</div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><img id="171754" src="description/43.jpg" alt="" width="675" height="199"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><strong>IMPORTANT</strong>: @InValues for this to work needs to be a parameter name that does not appear in anyother queries you create in the .xsd file, this will become apparent later on in the code section.</div>
<div class="endscriptcode"><span style="color:#ffffff">.</span></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Once the above is in place, save it. I gave it a decent name for when it comes down to writing code in a form. Now right click on CustomersTableAdapter and select &quot;View code&quot;</div>
<div class="endscriptcode"><img id="171755" src="description/a402e634-d4f6-4e2c-90e4-9a4eb173d9ee43.jpg" alt="" width="250" height="284"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">The following is shown</div>
<div class="endscriptcode">
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">namespace Where_In_CS
{
    partial class DataSet1
    {
        partial class CustomersDataTable
        {
        }
    }
}</pre>
<div class="preview">
<pre class="js">namespace&nbsp;Where_In_CS&nbsp;
<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;partial&nbsp;class&nbsp;DataSet1&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;partial&nbsp;class&nbsp;CustomersDataTable&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode">Below this create &nbsp;</div>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">public partial class CustomersTableAdapter
{
}</pre>
<div class="preview">
<pre class="js">public&nbsp;partial&nbsp;class&nbsp;CustomersTableAdapter&nbsp;
<span class="js__brace">{</span>&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode">Next open the xsd file as per below.</div>
<div class="endscriptcode"><img id="171756" src="description/aaaaa.jpg" alt="" width="430" height="484"></div>
<div class="endscriptcode">&nbsp;</div>
</div>
<div class="endscriptcode">Double click on the function highlighted and we get</div>
<div class="endscriptcode">
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">[global::<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.Diagnostics.DebuggerNonUserCodeAttribute.aspx"  title="Auto generated link to System.Diagnostics.DebuggerNonUserCodeAttribute">System.Diagnostics.DebuggerNonUserCodeAttribute</a>()]
[global::<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.CodeDom.Compiler.GeneratedCodeAttribute.aspx"  title="Auto generated link to System.CodeDom.Compiler.GeneratedCodeAttribute">System.CodeDom.Compiler.GeneratedCodeAttribute</a>(&quot;System.Data.Design.TypedDataSetGenerator&quot;, &quot;4.0.0.0&quot;)]
[global::<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.ComponentModel.Design.HelpKeywordAttribute.aspx"  title="Auto generated link to System.ComponentModel.Design.HelpKeywordAttribute">System.ComponentModel.Design.HelpKeywordAttribute</a>(&quot;vs.data.TableAdapter&quot;)]
[global::<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.ComponentModel.DataObjectMethodAttribute.aspx"  title="Auto generated link to System.ComponentModel.DataObjectMethodAttribute">System.ComponentModel.DataObjectMethodAttribute</a>(global::System.ComponentModel.DataObjectMethodType.Fill, false)]
public virtual int FillByInByCustomerIdentifier(DataSet1.CustomersDataTable dataTable, int InValues) {
    this.Adapter.SelectCommand = this.CommandCollection[2];
    this.Adapter.SelectCommand.Parameters[0].Value = ((int)(InValues));
    if ((this.ClearBeforeFill == true)) {
        dataTable.Clear();
    }
    int returnValue = this.Adapter.Fill(dataTable);
    return returnValue;
}</pre>
<div class="preview">
<pre class="js">[global::<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.Diagnostics.DebuggerNonUserCodeAttribute.aspx"  title="Auto generated link to System.Diagnostics.DebuggerNonUserCodeAttribute">System.Diagnostics.DebuggerNonUserCodeAttribute</a>()]&nbsp;
[global::<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.CodeDom.Compiler.GeneratedCodeAttribute.aspx"  title="Auto generated link to System.CodeDom.Compiler.GeneratedCodeAttribute">System.CodeDom.Compiler.GeneratedCodeAttribute</a>(<span class="js__string">&quot;System.Data.Design.TypedDataSetGenerator&quot;</span>,&nbsp;<span class="js__string">&quot;4.0.0.0&quot;</span>)]&nbsp;
[global::<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.ComponentModel.Design.HelpKeywordAttribute.aspx"  title="Auto generated link to System.ComponentModel.Design.HelpKeywordAttribute">System.ComponentModel.Design.HelpKeywordAttribute</a>(<span class="js__string">&quot;vs.data.TableAdapter&quot;</span>)]&nbsp;
[global::<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.ComponentModel.DataObjectMethodAttribute.aspx"  title="Auto generated link to System.ComponentModel.DataObjectMethodAttribute">System.ComponentModel.DataObjectMethodAttribute</a>(global::System.ComponentModel.DataObjectMethodType.Fill,&nbsp;false)]&nbsp;
public&nbsp;virtual&nbsp;int&nbsp;FillByInByCustomerIdentifier(DataSet1.CustomersDataTable&nbsp;dataTable,&nbsp;int&nbsp;InValues)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__operator">this</span>.Adapter.SelectCommand&nbsp;=&nbsp;<span class="js__operator">this</span>.CommandCollection[<span class="js__num">2</span>];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__operator">this</span>.Adapter.SelectCommand.Parameters[<span class="js__num">0</span>].Value&nbsp;=&nbsp;((int)(InValues));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">if</span>&nbsp;((<span class="js__operator">this</span>.ClearBeforeFill&nbsp;==&nbsp;true))&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataTable.Clear();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;returnValue&nbsp;=&nbsp;<span class="js__operator">this</span>.Adapter.Fill(dataTable);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">return</span>&nbsp;returnValue;&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode">This is how without modification the query is populated but we are going to alter it in the partial class above.</div>
<div class="endscriptcode"><span style="color:#ffffff">.</span></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Above I mentioned that the parameter @InValues can not be used more than in this query, it's because when we override the last code block we will search through the collection of command objects that were generated by the data wizards
 to find our query, remove the WHERE = condition and replace it with a WHERE IN condition.</div>
<div class="endscriptcode"><span style="color:#ffffff">.</span></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">The code below first iterates the commands looking for one with a parameter name of @InValues, when located the WHERE conditoin is removed and replaced with a string array that come in as a int array. The table is filled and sent
 back to the caller (in this case in a button click event).</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">using <a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.Data.SqlClient.aspx"  title="Auto generated link to System.Data.SqlClient">System.Data.SqlClient</a>;

namespace Where_In_CS
{
    partial class DataSet1
    {
        partial class CustomersDataTable
        {
        }
    }
}

namespace Where_In_CS.DataSet1TableAdapters {
    
    /// &lt;summary&gt;
    /// This is generated by selecting the adapter in the xsd file, right click and select &quot;view code&quot;
    /// which createsa shell for us to create our own implementation of the query that was originally 
    /// created in the xsd file.
    /// &lt;/summary&gt;
    public partial class CustomersTableAdapter
    {
        /// &lt;summary&gt;
        /// Return CustomerDataTable using a WHERE CustomerIdentifier IN clause e.g. 
        /// WHERE CustomerIdentifier IN (1,2,4)
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;dataTable&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;Values&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        /// &lt;remarks&gt;
        /// In this case I created a new SELECT in the xsd for the Customer table with 
        /// a WHERE condition that has a parameter named @InValues which is unique, 
        /// meaning no other queries in the xsd have this name.
        /// The code below then finds that query, removes the WHERE condition in place 
        /// of one with a IN clause and uses the int array (converted to a string array) 
        /// for returning records.
        /// &lt;/remarks&gt;
        public  int FillByInByCustomerIdentifier(DataSet1.CustomersDataTable dataTable, int[] Values)
        {

            for (int i = 0; i &lt; CommandCollection.Length; i&#43;&#43;)
            {
                if (CommandCollection[i].Parameters.Count &gt;0)
                {
                    foreach (SqlParameter item in CommandCollection[i].Parameters)
                    {                       
                        if (item.ParameterName == &quot;@InValues&quot;)
                        {
                            Adapter.SelectCommand = CommandCollection[i].Clone();
                            int whereLocation = Adapter.SelectCommand
                                .CommandText.IndexOf(&quot;WHERE&quot;, System.StringComparison.Ordinal);

                            var selectTextNoWhereCondition = Adapter.SelectCommand
                                .CommandText.Substring(0, whereLocation);
                            var newSelectStatmentText = selectTextNoWhereCondition &#43; 
                                &quot; WHERE CustomerIdentifier IN (&quot; &#43; string.Join(&quot;,&quot;, Values) &#43; &quot;)&quot;;

                            Adapter.SelectCommand = new SqlCommand() { Connection = this.Connection };
                            Adapter.SelectCommand.CommandText = newSelectStatmentText;

                            if ((ClearBeforeFill == true))
                            {
                                dataTable.Clear();
                            }

                            int returnValue = this.Adapter.Fill(dataTable);
                            return returnValue;

                        }
                    }
                }
            }

            throw new <a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.Exception.aspx"  title="Auto generated link to System.Exception">System.Exception</a>(&quot;Failed to locate SELECT&quot;);

        }
    }
}
</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">using</span>&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.Data.SqlClient.aspx"  title="Auto generated link to System.Data.SqlClient">System.Data.SqlClient</a>;&nbsp;
&nbsp;
<span class="cs__keyword">namespace</span>&nbsp;Where_In_CS&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;partial&nbsp;<span class="cs__keyword">class</span>&nbsp;DataSet1&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;partial&nbsp;<span class="cs__keyword">class</span>&nbsp;CustomersDataTable&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
}&nbsp;
&nbsp;
<span class="cs__keyword">namespace</span>&nbsp;Where_In_CS.DataSet1TableAdapters&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;This&nbsp;is&nbsp;generated&nbsp;by&nbsp;selecting&nbsp;the&nbsp;adapter&nbsp;in&nbsp;the&nbsp;xsd&nbsp;file,&nbsp;right&nbsp;click&nbsp;and&nbsp;select&nbsp;&quot;view&nbsp;code&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;which&nbsp;createsa&nbsp;shell&nbsp;for&nbsp;us&nbsp;to&nbsp;create&nbsp;our&nbsp;own&nbsp;implementation&nbsp;of&nbsp;the&nbsp;query&nbsp;that&nbsp;was&nbsp;originally&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;created&nbsp;in&nbsp;the&nbsp;xsd&nbsp;file.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;/summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">public</span>&nbsp;partial&nbsp;<span class="cs__keyword">class</span>&nbsp;CustomersTableAdapter&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;Return&nbsp;CustomerDataTable&nbsp;using&nbsp;a&nbsp;WHERE&nbsp;CustomerIdentifier&nbsp;IN&nbsp;clause&nbsp;e.g.&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;WHERE&nbsp;CustomerIdentifier&nbsp;IN&nbsp;(1,2,4)</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;/summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;param&nbsp;name=&quot;dataTable&quot;&gt;&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;param&nbsp;name=&quot;Values&quot;&gt;&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;returns&gt;&lt;/returns&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;remarks&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;In&nbsp;this&nbsp;case&nbsp;I&nbsp;created&nbsp;a&nbsp;new&nbsp;SELECT&nbsp;in&nbsp;the&nbsp;xsd&nbsp;for&nbsp;the&nbsp;Customer&nbsp;table&nbsp;with&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;a&nbsp;WHERE&nbsp;condition&nbsp;that&nbsp;has&nbsp;a&nbsp;parameter&nbsp;named&nbsp;@InValues&nbsp;which&nbsp;is&nbsp;unique,&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;meaning&nbsp;no&nbsp;other&nbsp;queries&nbsp;in&nbsp;the&nbsp;xsd&nbsp;have&nbsp;this&nbsp;name.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;The&nbsp;code&nbsp;below&nbsp;then&nbsp;finds&nbsp;that&nbsp;query,&nbsp;removes&nbsp;the&nbsp;WHERE&nbsp;condition&nbsp;in&nbsp;place&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;of&nbsp;one&nbsp;with&nbsp;a&nbsp;IN&nbsp;clause&nbsp;and&nbsp;uses&nbsp;the&nbsp;int&nbsp;array&nbsp;(converted&nbsp;to&nbsp;a&nbsp;string&nbsp;array)&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;for&nbsp;returning&nbsp;records.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;/remarks&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">public</span>&nbsp;&nbsp;<span class="cs__keyword">int</span>&nbsp;FillByInByCustomerIdentifier(DataSet1.CustomersDataTable&nbsp;dataTable,&nbsp;<span class="cs__keyword">int</span>[]&nbsp;Values)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">for</span>&nbsp;(<span class="cs__keyword">int</span>&nbsp;i&nbsp;=&nbsp;<span class="cs__number">0</span>;&nbsp;i&nbsp;&lt;&nbsp;CommandCollection.Length;&nbsp;i&#43;&#43;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">if</span>&nbsp;(CommandCollection[i].Parameters.Count&nbsp;&gt;<span class="cs__number">0</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">foreach</span>&nbsp;(SqlParameter&nbsp;item&nbsp;<span class="cs__keyword">in</span>&nbsp;CommandCollection[i].Parameters)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">if</span>&nbsp;(item.ParameterName&nbsp;==&nbsp;<span class="cs__string">&quot;@InValues&quot;</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adapter.SelectCommand&nbsp;=&nbsp;CommandCollection[i].Clone();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">int</span>&nbsp;whereLocation&nbsp;=&nbsp;Adapter.SelectCommand&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.CommandText.IndexOf(<span class="cs__string">&quot;WHERE&quot;</span>,&nbsp;System.StringComparison.Ordinal);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;selectTextNoWhereCondition&nbsp;=&nbsp;Adapter.SelectCommand&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.CommandText.Substring(<span class="cs__number">0</span>,&nbsp;whereLocation);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;newSelectStatmentText&nbsp;=&nbsp;selectTextNoWhereCondition&nbsp;&#43;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__string">&quot;&nbsp;WHERE&nbsp;CustomerIdentifier&nbsp;IN&nbsp;(&quot;</span>&nbsp;&#43;&nbsp;<span class="cs__keyword">string</span>.Join(<span class="cs__string">&quot;,&quot;</span>,&nbsp;Values)&nbsp;&#43;&nbsp;<span class="cs__string">&quot;)&quot;</span>;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adapter.SelectCommand&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;SqlCommand()&nbsp;{&nbsp;Connection&nbsp;=&nbsp;<span class="cs__keyword">this</span>.Connection&nbsp;};&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adapter.SelectCommand.CommandText&nbsp;=&nbsp;newSelectStatmentText;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">if</span>&nbsp;((ClearBeforeFill&nbsp;==&nbsp;<span class="cs__keyword">true</span>))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataTable.Clear();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">int</span>&nbsp;returnValue&nbsp;=&nbsp;<span class="cs__keyword">this</span>.Adapter.Fill(dataTable);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">return</span>&nbsp;returnValue;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">throw</span>&nbsp;<span class="cs__keyword">new</span>&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.Exception.aspx"  title="Auto generated link to System.Exception">System.Exception</a>(<span class="cs__string">&quot;Failed&nbsp;to&nbsp;locate&nbsp;SELECT&quot;</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
}&nbsp;
</pre>
</div>
</div>
</div>
<div class="endscriptcode">Now to implement the above let's look at the form.</div>
<div class="endscriptcode"><img id="171757" src="description/31.jpg" alt="" width="476" height="432"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">The list box is populated via a query created in the xsd file that returns a partial typed DataTable.</div>
<div class="endscriptcode"><img id="171758" src="description/0.jpg" alt="" width="218" height="122"></div>
<div class="endscriptcode">&nbsp;</div>
<div class="endscriptcode">We bind it as follows</div>
<div class="endscriptcode"><img id="171759" src="description/05.jpg" alt="" width="479" height="197"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Trying out our query, first run the SQL file (scripts.sql right in the project) in Visual Studio or SQL Server Management Studio to create the database and tables (well there are a few extra tables).</div>
<div class="endscriptcode"><span style="color:#ffffff">.</span></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Under project properties, Settings tabe, alter the ConnectionString, change Data Source from KARENS-PC to the name of your SQL-Server (might be .\SQLEXPRESS for instance).</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Build/run the project and you will get what is shown in the prior screenshot. Select several company names in the list box and press the &quot;Select in list&quot; button. You will get only those companies selected in the DataGridview which
 was originally showing all rows.</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Press &quot;All&quot; button to get all records. Note I keep the current record active after going from a filtered set of data to all data.</div>
<div class="endscriptcode"><span style="color:#ffffff">.</span></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Last note, be sure to note how I created the list of ints, this could also be done with a CheckedListBox rather than a ListBox. If you like to use a CheckListBox see my MSDN
<a href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/Working-with-CheckedListBox-3b765442">code sample</a> on how to work with them.</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Full form code listing</div>
<div class="endscriptcode">
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">using System;
using <a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.Data.aspx"  title="Auto generated link to System.Data">System.Data</a>;
using <a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.Linq.aspx"  title="Auto generated link to System.Linq">System.Linq</a>;
using <a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.Windows.Forms.aspx"  title="Auto generated link to System.Windows.Forms">System.Windows.Forms</a>;

namespace Where_In_CS
{
    public partial class Form1 : Form
    {
        string customerPrimaryKeyName = &quot;CustomerIdentifier&quot;;
        public Form1()
        {
            InitializeComponent();
        }
        /// &lt;summary&gt;
        /// Add/Edit/Delete operations are not part of this code sample
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        private void customersBindingNavigatorSaveItem_Click(object sender, EventArgs e)
        {
            MessageBox.Show(&quot;CRUD operations not implemented for this code sample&quot;);
        }
        /// &lt;summary&gt;
        /// In short this is the default code injected by the data wizards, I simply
        /// removed the comments.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        private void Form1_Load(object sender, EventArgs e)
        {
            this.customersTableAdapter.Fill(this.dataSet1.Customers);
            this.customersNamesTableAdapter.Fill(this.dataSet1.CustomersNames);
        }
        /// &lt;summary&gt;
        /// Normal fill, clear selections in listbox
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        private void clearForCustomerIdentifierQueryButton_Click(object sender, EventArgs e)
        {
            ClearItemsForCustomerIdentifier();
        }
        /// &lt;summary&gt;
        /// If there are selected items in the ListBox, cast each item to a DataRowView to
        /// access the primary key at the DataRow level to pass into our customer fill method
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        void selectByCustomerIdentifierButton_Click(object sender, EventArgs e)
        {
            var items = listBox1.SelectedItems;
            if (items != null)
            {
                // create an array of primary keys to send to our custom select
                var customeridentifiers = items.Cast&lt;DataRowView&gt;().ToList()
                    .Select(view =&gt; view.Row.Field&lt;int&gt;(customerPrimaryKeyName)).ToArray();

                // this is our overrridden query which is modified in DataSet.cs 
                // which you can view by right clicking on FillByInByCustomerIdentifier and
                // select go to definition
                customersTableAdapter
                    .FillByInByCustomerIdentifier(dataSet1.Customers, customeridentifiers);
            }
            else
            {
                ClearItemsForCustomerIdentifier();
            }
        }
        /// &lt;summary&gt;
        /// reset after a filter was applied for customer id query
        /// &lt;/summary&gt;
        void ClearItemsForCustomerIdentifier()
        {

            listBox1.SelectedItems.Clear();

            if (customersBindingSource.Current != null)
            {
                var id = ((DataRowView)customersBindingSource.Current)
                    .Row.Field&lt;int&gt;(customerPrimaryKeyName);

                var colIndex = customersDataGridView.CurrentCellAddress.X;
                
                customersTableAdapter.Fill(this.dataSet1.Customers);

                if (chkRemember.Checked)
                {
                    var index = customersBindingSource.Find(customerPrimaryKeyName, id);
                    if (index != -1)
                    {
                        customersBindingSource.Position = index;
                        customersDataGridView.CurrentCell = 
                            customersDataGridView.Rows[index].Cells[colIndex];
                    }
                }
            }
        }
        /// &lt;summary&gt;
        /// Hide/show panel for focus on the DataGridView
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        private void TogglePanelButton_Click(object sender, EventArgs e)
        {
            panel1.Visible = !panel1.Visible;
        }
    }
}
</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">using</span>&nbsp;System;&nbsp;
<span class="cs__keyword">using</span>&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.Data.aspx"  title="Auto generated link to System.Data">System.Data</a>;&nbsp;
<span class="cs__keyword">using</span>&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.Linq.aspx"  title="Auto generated link to System.Linq">System.Linq</a>;&nbsp;
<span class="cs__keyword">using</span>&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://code.msdn.microsoft.com/TableAdapter-WHERE-IN-456d8b74/https://msdn.microsoft.com/en-US/library/System.Windows.Forms.aspx"  title="Auto generated link to System.Windows.Forms">System.Windows.Forms</a>;&nbsp;
&nbsp;
<span class="cs__keyword">namespace</span>&nbsp;Where_In_CS&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">public</span>&nbsp;partial&nbsp;<span class="cs__keyword">class</span>&nbsp;Form1&nbsp;:&nbsp;Form&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;customerPrimaryKeyName&nbsp;=&nbsp;<span class="cs__string">&quot;CustomerIdentifier&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">public</span>&nbsp;Form1()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitializeComponent();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;Add/Edit/Delete&nbsp;operations&nbsp;are&nbsp;not&nbsp;part&nbsp;of&nbsp;this&nbsp;code&nbsp;sample</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;/summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;param&nbsp;name=&quot;sender&quot;&gt;&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;param&nbsp;name=&quot;e&quot;&gt;&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">private</span>&nbsp;<span class="cs__keyword">void</span>&nbsp;customersBindingNavigatorSaveItem_Click(<span class="cs__keyword">object</span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox.Show(<span class="cs__string">&quot;CRUD&nbsp;operations&nbsp;not&nbsp;implemented&nbsp;for&nbsp;this&nbsp;code&nbsp;sample&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;In&nbsp;short&nbsp;this&nbsp;is&nbsp;the&nbsp;default&nbsp;code&nbsp;injected&nbsp;by&nbsp;the&nbsp;data&nbsp;wizards,&nbsp;I&nbsp;simply</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;removed&nbsp;the&nbsp;comments.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;/summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;param&nbsp;name=&quot;sender&quot;&gt;&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;param&nbsp;name=&quot;e&quot;&gt;&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">private</span>&nbsp;<span class="cs__keyword">void</span>&nbsp;Form1_Load(<span class="cs__keyword">object</span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">this</span>.customersTableAdapter.Fill(<span class="cs__keyword">this</span>.dataSet1.Customers);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">this</span>.customersNamesTableAdapter.Fill(<span class="cs__keyword">this</span>.dataSet1.CustomersNames);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;Normal&nbsp;fill,&nbsp;clear&nbsp;selections&nbsp;in&nbsp;listbox</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;/summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;param&nbsp;name=&quot;sender&quot;&gt;&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;param&nbsp;name=&quot;e&quot;&gt;&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">private</span>&nbsp;<span class="cs__keyword">void</span>&nbsp;clearForCustomerIdentifierQueryButton_Click(<span class="cs__keyword">object</span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClearItemsForCustomerIdentifier();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;If&nbsp;there&nbsp;are&nbsp;selected&nbsp;items&nbsp;in&nbsp;the&nbsp;ListBox,&nbsp;cast&nbsp;each&nbsp;item&nbsp;to&nbsp;a&nbsp;DataRowView&nbsp;to</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;access&nbsp;the&nbsp;primary&nbsp;key&nbsp;at&nbsp;the&nbsp;DataRow&nbsp;level&nbsp;to&nbsp;pass&nbsp;into&nbsp;our&nbsp;customer&nbsp;fill&nbsp;method</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;/summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;param&nbsp;name=&quot;sender&quot;&gt;&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;param&nbsp;name=&quot;e&quot;&gt;&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">void</span>&nbsp;selectByCustomerIdentifierButton_Click(<span class="cs__keyword">object</span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;items&nbsp;=&nbsp;listBox1.SelectedItems;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">if</span>&nbsp;(items&nbsp;!=&nbsp;<span class="cs__keyword">null</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;create&nbsp;an&nbsp;array&nbsp;of&nbsp;primary&nbsp;keys&nbsp;to&nbsp;send&nbsp;to&nbsp;our&nbsp;custom&nbsp;select</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;customeridentifiers&nbsp;=&nbsp;items.Cast&lt;DataRowView&gt;().ToList()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Select(view&nbsp;=&gt;&nbsp;view.Row.Field&lt;<span class="cs__keyword">int</span>&gt;(customerPrimaryKeyName)).ToArray();&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;this&nbsp;is&nbsp;our&nbsp;overrridden&nbsp;query&nbsp;which&nbsp;is&nbsp;modified&nbsp;in&nbsp;DataSet.cs&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;which&nbsp;you&nbsp;can&nbsp;view&nbsp;by&nbsp;right&nbsp;clicking&nbsp;on&nbsp;FillByInByCustomerIdentifier&nbsp;and</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;select&nbsp;go&nbsp;to&nbsp;definition</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;customersTableAdapter&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.FillByInByCustomerIdentifier(dataSet1.Customers,&nbsp;customeridentifiers);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">else</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClearItemsForCustomerIdentifier();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;reset&nbsp;after&nbsp;a&nbsp;filter&nbsp;was&nbsp;applied&nbsp;for&nbsp;customer&nbsp;id&nbsp;query</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;/summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">void</span>&nbsp;ClearItemsForCustomerIdentifier()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listBox1.SelectedItems.Clear();&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">if</span>&nbsp;(customersBindingSource.Current&nbsp;!=&nbsp;<span class="cs__keyword">null</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;id&nbsp;=&nbsp;((DataRowView)customersBindingSource.Current)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Row.Field&lt;<span class="cs__keyword">int</span>&gt;(customerPrimaryKeyName);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;colIndex&nbsp;=&nbsp;customersDataGridView.CurrentCellAddress.X;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;customersTableAdapter.Fill(<span class="cs__keyword">this</span>.dataSet1.Customers);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">if</span>&nbsp;(chkRemember.Checked)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;index&nbsp;=&nbsp;customersBindingSource.Find(customerPrimaryKeyName,&nbsp;id);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">if</span>&nbsp;(index&nbsp;!=&nbsp;-<span class="cs__number">1</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;customersBindingSource.Position&nbsp;=&nbsp;index;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;customersDataGridView.CurrentCell&nbsp;=&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;customersDataGridView.Rows[index].Cells[colIndex];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;Hide/show&nbsp;panel&nbsp;for&nbsp;focus&nbsp;on&nbsp;the&nbsp;DataGridView</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;/summary&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;param&nbsp;name=&quot;sender&quot;&gt;&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;param&nbsp;name=&quot;e&quot;&gt;&lt;/param&gt;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">private</span>&nbsp;<span class="cs__keyword">void</span>&nbsp;TogglePanelButton_Click(<span class="cs__keyword">object</span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel1.Visible&nbsp;=&nbsp;!panel1.Visible;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
}&nbsp;
</pre>
</div>
</div>
</div>
<div class="endscriptcode">In closing, you can do the same with string or dates also, simply change from an int array to either a string or date (of course there of different date types e.g. DateTimeOffset etc) array.</div>
</div>
</div>
</div>
</span></div>

</div>


    </div>
</body>
</html>
