<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=22975FC52BB0E2A54E47AF5E041339D0" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=12CBF884F006EDBA1B922DFD3FD2FFE5" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Simple connection methods for MS-Access using OleDb data provider</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Simple connection methods for MS-Access using OleDb data provider</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Data Access, OLEDB, ACE.OLEDB
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Windows Forms, Data Access, Databases
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">5/31/2016</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/Simple-connection-methods-2eb58ef7">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Description</h1>
<p><span style="font-size:small">Microsoft Access database, for many new developers just starting out is there choice for learning how to work with databases. There are a handful of methods to interact with MS-Access databases where one uses OleDb, a managed
 data provider. When working with OleDb one simple needs to create a connection object and a command object to do CRUD (Create, Read, Update and Delete operations). At the command object level you might uses a DataTable to return a record-set, use a DataReader
 to cycle through returned data etc.</span><br>
<br>
<span style="font-size:small">The focus here is creating the connection string. The majority of new developers will create a connection string by concatenating various properties of the connection string together which can lead to issues when done incorrectly.
 This is where the OleDbConnectionStringBuilder class shines in that you instantiate a new instance of the OleDbConnectionStringBuilder class and set two properties, Provider which denotes the name of the data provider associated with the internal connection
 string and the DataSource which represents (in this case) the full path and file name of the database to open. Before going any farther I would suggest reviewing the other properties and methods of the OleDbConnectionStringBuilder.</span><br>
<br>
<span style="font-size:small">Okay, getting to the point of why have a method presented here to create a connection string which we can feed to the connection object, OleDbConnection. &nbsp;There are two major versions of MS-Access, one ends with .MDB while
 the other ends with .ACCDB extension. Both require different providers which brings us to the code in this code sample.</span></p>
<p><span style="font-size:x-small">The code below is a function turned into a language extension method,
<a href="https://code.msdn.microsoft.com/Simple-connection-methods-2eb58ef7/https://msdn.microsoft.com/en-us/library/bb383977.aspx">C# description</a> and
<a href="https://code.msdn.microsoft.com/Simple-connection-methods-2eb58ef7/https://msdn.microsoft.com/en-us/library/bb384936.aspx">VB.NET description</a>.</span></p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>Visual Basic</span><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">vb</span><span class="hidden">csharp</span>
<pre class="hidden">Imports <a class="libraryLink" href="https://code.msdn.microsoft.com/Simple-connection-methods-2eb58ef7/https://code.msdn.microsoft.com/Simple-connection-methods-2eb58ef7/https://msdn.microsoft.com/en-US/library/System.Data.OleDb.aspx"  title="Auto generated link to System.Data.OleDb">System.Data.OleDb</a>

Public Module ConnectionsAccess
    Private providers As New Dictionary(Of String, String)() From {{&quot;.accdb&quot;, &quot;Microsoft.ACE.OLEDB.12.0&quot;}, {&quot;.mdb&quot;, &quot;Microsoft.Jet.OLEDB.4.0&quot;}}

    &lt;System.Diagnostics.DebuggerStepThrough()&gt;
    &lt;System.Runtime.CompilerServices.Extension()&gt;
    Public Function BuildConnectionString(ByVal DatabaseName As String) As String

        Dim Builder As OleDbConnectionStringBuilder = New OleDbConnectionStringBuilder With
            {
                .Provider = providers(IO.Path.GetExtension(DatabaseName).ToLower()),
                .DataSource = DatabaseName
            }

        Return Builder.ConnectionString

    End Function
End Module
</pre>
<pre class="hidden">using <a class="libraryLink" href="https://code.msdn.microsoft.com/Simple-connection-methods-2eb58ef7/https://msdn.microsoft.com/en-US/library/System.IO.aspx"  title="Auto generated link to System.IO">System.IO</a>;
using <a class="libraryLink" href="https://code.msdn.microsoft.com/Simple-connection-methods-2eb58ef7/https://code.msdn.microsoft.com/Simple-connection-methods-2eb58ef7/https://msdn.microsoft.com/en-US/library/System.Data.OleDb.aspx"  title="Auto generated link to System.Data.OleDb">System.Data.OleDb</a>;
using <a class="libraryLink" href="https://code.msdn.microsoft.com/Simple-connection-methods-2eb58ef7/https://msdn.microsoft.com/en-US/library/System.Collections.Generic.aspx"  title="Auto generated link to System.Collections.Generic">System.Collections.Generic</a>;

namespace AccessConnections_cs
{
    public static class ConnectionsAccess
    {
        private static Dictionary&lt;string, string&gt; providers = new Dictionary&lt;string, string&gt;()
        {
            { &quot;.accdb&quot; , &quot;Microsoft.ACE.OLEDB.12.0&quot; },
            { &quot;.mdb&quot; , &quot;Microsoft.Jet.OLEDB.4.0&quot; }
        };

        public static string BuildConnectionString(this string DatabaseName)
        {

            OleDbConnectionStringBuilder Builder = new OleDbConnectionStringBuilder
            {
                Provider = providers[Path.GetExtension(DatabaseName).ToLower()],
                DataSource = DatabaseName
            };

            return Builder.ConnectionString;

        }
    }
}
</pre>
<div class="preview">
<pre class="vb"><span class="visualBasic__keyword">Imports</span>&nbsp;System.Data.OleDb&nbsp;
&nbsp;
<span class="visualBasic__keyword">Public</span>&nbsp;<span class="visualBasic__keyword">Module</span>&nbsp;ConnectionsAccess&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Private</span>&nbsp;providers&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">New</span>&nbsp;Dictionary(<span class="visualBasic__keyword">Of</span>&nbsp;<span class="visualBasic__keyword">String</span>,&nbsp;<span class="visualBasic__keyword">String</span>)()&nbsp;From&nbsp;{{<span class="visualBasic__string">&quot;.accdb&quot;</span>,&nbsp;<span class="visualBasic__string">&quot;Microsoft.ACE.OLEDB.12.0&quot;</span>},&nbsp;{<span class="visualBasic__string">&quot;.mdb&quot;</span>,&nbsp;<span class="visualBasic__string">&quot;Microsoft.Jet.OLEDB.4.0&quot;</span>}}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;System.Diagnostics.DebuggerStepThrough()&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;System.Runtime.CompilerServices.Extension()&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Public</span>&nbsp;<span class="visualBasic__keyword">Function</span>&nbsp;BuildConnectionString(<span class="visualBasic__keyword">ByVal</span>&nbsp;DatabaseName&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>)&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;Builder&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;OleDbConnectionStringBuilder&nbsp;=&nbsp;<span class="visualBasic__keyword">New</span>&nbsp;OleDbConnectionStringBuilder&nbsp;<span class="visualBasic__keyword">With</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Provider&nbsp;=&nbsp;providers(IO.Path.GetExtension(DatabaseName).ToLower()),&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.DataSource&nbsp;=&nbsp;DatabaseName&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Return</span>&nbsp;Builder.ConnectionString&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Function</span>&nbsp;
<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Module</span>&nbsp;
</pre>
</div>
</div>
</div>
<p><span style="font-size:small">These extension methods do basically one thing, which is look at the file passed in, get it's extension and retrieve the proper provider from a dictionary. The provider is set in the &nbsp;new instance of our&nbsp;OleDbConnectionStringBuilder
 and the file name passed in is set as the DataSource.</span></p>
<p><span style="font-size:small">The usage is simple, call the extension method on the file name as the extension method is for strings which our file name is.</span></p>
<p><span style="font-size:small"></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span><span class="hidden">vb</span>
<pre class="hidden">using (OleDbConnection cn = new OleDbConnection { ConnectionString = fileName.BuildConnectionString() })</pre>
<pre class="hidden">Using cn As New OleDb.OleDbConnection With {.ConnectionString = fileName.BuildConnectionString}</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">using</span>&nbsp;(OleDbConnection&nbsp;cn&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;OleDbConnection&nbsp;{&nbsp;ConnectionString&nbsp;=&nbsp;fileName.BuildConnectionString()&nbsp;})</pre>
</div>
</div>
</div>
<div class="endscriptcode">How to implement into your project, add the appropriate languge class project to your solution, add a reference to the project you are working with MS-Access and create your connection the same or similar as I have done in the demo
 projects.</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">As in the demo projects I always use a Using statement so to access data then immediately dispose of all objects rather than using a global connection which is not so much a big deal in desktop projects but usually is with web applications.</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Even after getting passed the novice stage of coding these methods are still valuable in your toolbox as they simply work and are out of sight. Sure there are other ways to do what has been shown here, it's up to you to decide what
 is best for your style of coding.</div>
<br>
</span>
<p></p>
<p>&nbsp;</p>
<p><span style="font-size:small"><br>
</span></p>

</div>


    </div>
</body>
</html>
