<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=2045FD7A6E627F471DA2371FE578A63B" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:FooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=5C0A3A6AD580964D88CAF6AE235CF2A6" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Test database connection via C#</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Test database connection via C#</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, SQL Server, .NET Framework
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Controls, C#, ASP.NET, Windows Forms, Data Access, Code Sample, C# Language Features
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        Microsoft Visual Studio 2012 SDK
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">pt-BR</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">9/13/2015</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/Test-database-connection-abad6ce0">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p><em>You want to validate the database connection, but withou using the database management studio. Is it possible? With this program, you can do it with a SQL connection, just typing the essential data to it. Above it described some steps of this project.</em></p>
<p><em>Just for information, to execute this program is necessary the framework .net 4.5.</em></p>
<p>---------------------------------------</p>
<p>Voc&ecirc; quer validar a conex&atilde;o com o banco de dados, mas sem usar o seu gerenciador de banco. &Eacute; poss&iacute;vel? Com esse programa voc&ecirc; valida uma conex&atilde;o com o SQL, apenas digitando os dados b&aacute;sicos para isso. Abaixo
 est&aacute; descrito alguns passos do projeto.</p>
<p>Apenas como informa&ccedil;&atilde;o, para executar esse programa &eacute; necess&aacute;rio o framework .net 4.5 instalado no computador.</p>
<h1>Description</h1>
<p><em>To develop this program it is necessary to use just the framework .net components, not any another library. So first of all, use the&nbsp;SqlConnection class to create a new instance, using the essential data as the parameters. Then, verify if the connection
 will open and, if so, it was valid. If not, the program will show an error message, with the SQL specific details.</em></p>
<p><em>The erros that is possible to be shown is that the user &quot;A&quot; doesn't exist, the database &quot;X&quot; doesn't exist, the server was not found and other types.</em></p>
<p>---------------------------------------</p>
<p>Para desenvolver esse programa, &eacute; necess&aacute;rio utilizar apenas os componentes do framework .net, sem nenhuma outra biblioteca. Primeiro, utilize a classe&nbsp;<em>SqlConnection para criar uma nova inst&acirc;ncia, usando apenas os dados essenciais
 como par&acirc;metro. Depois, verifique se a conex&atilde;o foi aberta e, em caso positivo, a conex&atilde;o &eacute; v&aacute;lida. Em caso negativo, o programa ir&aacute; exibir uma mensagem de erro, com os detalhes espec&iacute;ficos do SQL.</em></p>
<p><em>Os erros poss&iacute;veis s&atilde;o por causa do usu&aacute;rio &quot;A&quot; n&atilde;o existir, o banco &quot;X&quot; n&atilde;o existir, o servidor n&atilde;o foi encontrado, entre outros tipos.</em></p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Editar Script</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">try
{
       //----------------PT-BR----------------//
       // Tenta abrir a conex&atilde;o com o banco de dados.
       //----------------EN-US----------------//
       // Try to open the connection with the database.
       connection.Open();

       //----------------PT-BR----------------//
       // Se a conex&atilde;o estiver aberta, &eacute; executado o bloco abaixo. 
       //----------------EN-US----------------//
       // If the connection is open, the code below is executed.
       if (connection.State == ConnectionState.Open)
       {
              //----------------PT-BR----------------//
              // Fecha a conex&atilde;o, pois j&aacute; entrou na condi&ccedil;&atilde;o.
              //----------------EN-US----------------//
              // Close the connection, because it's inside this condition.
              connection.Close();

              MessageBox.Show(&quot;A conex&atilde;o est&aacute; v&aacute;lida!&quot;, &quot;Sucesso&quot;, MessageBoxButtons.OK, MessageBoxIcon.Information);
       }
}</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">try</span>&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//----------------PT-BR----------------//</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;Tenta&nbsp;abrir&nbsp;a&nbsp;conex&atilde;o&nbsp;com&nbsp;o&nbsp;banco&nbsp;de&nbsp;dados.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//----------------EN-US----------------//</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;Try&nbsp;to&nbsp;open&nbsp;the&nbsp;connection&nbsp;with&nbsp;the&nbsp;database.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.Open();&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//----------------PT-BR----------------//</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;Se&nbsp;a&nbsp;conex&atilde;o&nbsp;estiver&nbsp;aberta,&nbsp;&eacute;&nbsp;executado&nbsp;o&nbsp;bloco&nbsp;abaixo.&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//----------------EN-US----------------//</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;If&nbsp;the&nbsp;connection&nbsp;is&nbsp;open,&nbsp;the&nbsp;code&nbsp;below&nbsp;is&nbsp;executed.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">if</span>&nbsp;(connection.State&nbsp;==&nbsp;ConnectionState.Open)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//----------------PT-BR----------------//</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;Fecha&nbsp;a&nbsp;conex&atilde;o,&nbsp;pois&nbsp;j&aacute;&nbsp;entrou&nbsp;na&nbsp;condi&ccedil;&atilde;o.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//----------------EN-US----------------//</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;Close&nbsp;the&nbsp;connection,&nbsp;because&nbsp;it's&nbsp;inside&nbsp;this&nbsp;condition.</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.Close();&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox.Show(<span class="cs__string">&quot;A&nbsp;conex&atilde;o&nbsp;est&aacute;&nbsp;v&aacute;lida!&quot;</span>,&nbsp;<span class="cs__string">&quot;Sucesso&quot;</span>,&nbsp;MessageBoxButtons.OK,&nbsp;MessageBoxIcon.Information);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
}</pre>
</div>
</div>
</div>
<h1><span>Source Code Files</span></h1>
<p><span>In the class below is located the code that execute all these rules.</span></p>
<ul>
<li><em>Form1.cs</em> </li></ul>
<p>---------------------------------------</p>
<p>Na classe abaixo est&aacute; localizado o c&oacute;digo que executa todas essas regras.</p>
<ul>
<li><em>Form1.cs</em> </li></ul>
<p><span style="font-size:2em">More Information</span></p>
<p><em>This program was developed using the Visual Studio 2012 and the framework .net 4.5.</em></p>
<p>---------------------------------------</p>
<p>Esse programa foi desenvolvido utilizando o Visual Studio 2012 e o framework .net 4.5</p>
<p><em><br>
</em></p>

</div>


    </div>
</body>
</html>
