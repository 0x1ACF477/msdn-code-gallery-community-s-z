<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=C911D510A8FF96468115FC697F48DB9C" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:FooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=3B88C67755B382DB6EC23F09A048D6C2" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Simple Multi-User TCP/IP Client/Server Example (Depreciated!)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Simple Multi-User TCP/IP Client/Server Example (Depreciated!)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Obsolete
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            TCP/IP Client/Server
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">3/22/2015</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/Simple-Multi-User-TCPIP-43cc3b44">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Update 3/22/2015</h1>
<h1>This sample is now <span style="color:#ff0000"><strong>obsolete</strong></span>. &nbsp;</h1>
<p>For the current client/server sample, please see this link:</p>
<p><a href="https://code.msdn.microsoft.com/Simple-Multi-User-TCPIP-43cc3b44/https://code.msdn.microsoft.com/Simple-Multi-User-TCPIP-1ff0da41">https://code.msdn.microsoft.com/Simple-Multi-User-TCPIP-43cc3b44/https://code.msdn.microsoft.com/Simple-Multi-User-TCPIP-1ff0da41</a></p>
<p>For a detailed explaination of the solution's code, please see the Technet Wiki article:</p>
<p><a href="http://social.technet.microsoft.com/wiki/contents/articles/30394.simple-multi-user-tcpip-client-server-using-tap.aspx" >Simple Multi-User TCP/IP Client &amp; Server using TAP</a></p>
<h4>Update 10/25/2013</h4>
<p>The sample has been updated to use a concurrent queue within the server.&nbsp; The previous example lacked thread synchronization when emptying the data queue and this could cause problems in some scenarios.</p>
<h1>Introduction</h1>
<p>This sample provides an example of a simple pair of client and server programs which communicate with each other over TCP/IP.&nbsp; The example uses
<strong>Async </strong>methods to connect and read data, and a <strong>Task </strong>
object to monitor client connections on the server.</p>
<p>While the sample does not attempt to implement any kind of data transmission protocol, it does include comments to indicate places where the code might be changed substantially in support of a custom protocol.</p>
<h1><span>Building the Sample</span></h1>
<p>The sample solution is configured to run one instance each of the client and server projects when clicking the Run button in Visual Studio.&nbsp; Once debugging has begun, you can return to the
<em>Solution Explorer</em>, right click the <strong>ClientExample </strong>project, and select
<em>Debug -&gt; Start New Instance</em> in order to start additional client instances and test multiple users.</p>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<p>This example shows a simple communication stream between a client and a server over TCP/IP.&nbsp; The server program also demonstrates a simple multi-threaded&nbsp;connection monitoring routine.</p>
<p>The example programs do not attempt to implement a data transmission protocol.&nbsp; All messages are read in 64 byte chunks and the server does not attempt to relate multi-part messages from clients.&nbsp; However, comments in the code indicate the places
 where changes would be made to accomodate multi-part messages and/or alternate message frame size schemes.</p>
<p>A client/server application is a two-part problem: first you must define the raw data transmission methodology for the programs, and second you must then implement a data transmission protocol to control the flow of the raw data and make it meaningful to
 the applications.&nbsp; This sample only attempts to deal with the first part of the problem; transmitting the raw data.</p>
<p><img id="59309" src="description/client-server-example.jpg" alt="" width="743" height="404"></p>
<p>&nbsp;</p>
<h1><span>Source Code Files</span></h1>
<ul>
<li><em>ServerForm.vb&nbsp;- contains the ServerForm class, MonitorInfo class, and ConnectionInfo class</em>
</li><li><em><em>ClientForm.vb&nbsp;- contains the ClientForm class and ConnectionInfo class</em></em>
</li></ul>
<h1>More Information</h1>
<p><em>This sample was the result of a discussion on the MSDN Forums at:<br>
<a href="http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/602d926e-a09c-4c95-9af4-61833a1afcab">http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/602d926e-a09c-4c95-9af4-61833a1afcab</a></em></p>

</div>


    </div>
</body>
</html>
