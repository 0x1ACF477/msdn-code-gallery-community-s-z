<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/4f0db316-e33e-4e5c-b975-0f6de635f8e4Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Using Data Template Selector with WPF</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Using Data Template Selector with WPF</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            WPF
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Data Binding, ValueConverters<wbr />, DataTemplates, DataTemplateSel<wbr />ector
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">10/26/2012</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Using-Data-Template-f6dc23c8">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p><em>Have you ever had to put in the same list Persons &amp; Companies? If so, depends on the selected one, a different bunch of information has to be displayed. It's a kind of annoying to be done in the old Win Forms application, by controlling visible properties
 and so one. With WPF things has changed and it is easier then ever. Lets see it in practice.</em></p>
<p><em><img id="69321" src="description/template_company.jpg" alt="" width="485" height="300"></em></p>
<h1><span>Building the Sample</span></h1>
<p><em>Just download the example, build it and run.</em></p>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<p><em>To achieve this object, I've used an Interface to sign Persons and Companies as Users from my system, so I've created the ISystemUser interface, with is implemented by the classes: Person and Enterprise. They shared the Name property but the other properties
 is implemented direct by Person and Enterprise individually, so Partners is a property that is held just by Enterprise.</em></p>
<p><em>In order to list all both, the constructor of my&nbsp;MVVW (Window1ViewModel) populates an IList&lt;ISystemUser&gt;, defining some people and some companies.</em></p>
<p><em>Once I have just one list, I binded it direct to my ListBox. In order to control the icon it generates I used an ValueConverter so if the implementation is a Person, it shows a Person. You can take a deep look at the class Class2IconConverter.</em></p>
<p><em>And just above the ListBox we have a ContentControl to show the detailed information about the selected item. Take a look at the XAML to see how this control is direct binded to the ListBox and in order to determine the template it will use, it takes
 advantage of ContentTemplateSelector, making the show happens.</em></p>
<p><em>&nbsp;</em></p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span><span>XAML</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span><span class="hidden">xaml</span>
<pre class="hidden">public class SystemUserTemplateSelection : DataTemplateSelector
{
    public override <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Windows.DataTemplate.aspx"  title="Auto generated link to System.Windows.DataTemplate">System.Windows.DataTemplate</a> SelectTemplate(object item, <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Windows.DependencyObject.aspx"  title="Auto generated link to System.Windows.DependencyObject">System.Windows.DependencyObject</a> container)
    {
        DataTemplate dt = null;

        if (item is Person)
            dt = App.Current.MainWindow.FindResource(&quot;templatePerson&quot;) as DataTemplate;

        if (item is Enterprise)
            dt = App.Current.MainWindow.FindResource(&quot;templateCompany&quot;) as DataTemplate;

        return dt;
    }
}</pre>
<pre class="hidden">&lt;ListBox ItemsSource=&quot;{Binding Users}&quot; x:Name=&quot;myListBox&quot;&gt;
    &lt;ListBox.ItemTemplate&gt;
        &lt;DataTemplate&gt;
            &lt;Border Margin=&quot;5&quot; CornerRadius=&quot;5&quot; BorderThickness=&quot;1&quot; BorderBrush=&quot;Black&quot;&gt;
                &lt;Grid Width=&quot;80&quot;&gt;
                    &lt;Grid.RowDefinitions&gt;
                        &lt;RowDefinition Height=&quot;*&quot; /&gt;
                        &lt;RowDefinition Height=&quot;40&quot; /&gt;
                    &lt;/Grid.RowDefinitions&gt;
                    &lt;Image Source=&quot;{Binding ., Converter={StaticResource c2iConv}}&quot; /&gt;                            
                    &lt;TextBlock Grid.Row=&quot;1&quot; Margin=&quot;5&quot; Text=&quot;{Binding Name}&quot; TextWrapping=&quot;Wrap&quot; HorizontalAlignment=&quot;Center&quot; /&gt;
                &lt;/Grid&gt;
            &lt;/Border&gt;
        &lt;/DataTemplate&gt;
    &lt;/ListBox.ItemTemplate&gt;
    &lt;ListBox.ItemsPanel&gt;
        &lt;ItemsPanelTemplate&gt;
            &lt;StackPanel Orientation=&quot;Horizontal&quot; IsItemsHost=&quot;True&quot; /&gt;
        &lt;/ItemsPanelTemplate&gt;
    &lt;/ListBox.ItemsPanel&gt;
&lt;/ListBox&gt;

&lt;ContentControl Grid.Row=&quot;1&quot; Content=&quot;{Binding ElementName=myListBox, Path=SelectedItem}&quot; ContentTemplateSelector=&quot;{StaticResource systemUserTemplateSelector}&quot; /&gt;</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">public</span>&nbsp;<span class="cs__keyword">class</span>&nbsp;SystemUserTemplateSelection&nbsp;:&nbsp;DataTemplateSelector&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">public</span>&nbsp;<span class="cs__keyword">override</span>&nbsp;System.Windows.DataTemplate&nbsp;SelectTemplate(<span class="cs__keyword">object</span>&nbsp;item,&nbsp;System.Windows.DependencyObject&nbsp;container)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTemplate&nbsp;dt&nbsp;=&nbsp;<span class="cs__keyword">null</span>;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">if</span>&nbsp;(item&nbsp;<span class="cs__keyword">is</span>&nbsp;Person)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dt&nbsp;=&nbsp;App.Current.MainWindow.FindResource(<span class="cs__string">&quot;templatePerson&quot;</span>)&nbsp;<span class="cs__keyword">as</span>&nbsp;DataTemplate;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">if</span>&nbsp;(item&nbsp;<span class="cs__keyword">is</span>&nbsp;Enterprise)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dt&nbsp;=&nbsp;App.Current.MainWindow.FindResource(<span class="cs__string">&quot;templateCompany&quot;</span>)&nbsp;<span class="cs__keyword">as</span>&nbsp;DataTemplate;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">return</span>&nbsp;dt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
}</pre>
</div>
</div>
</div>
<h1><span>Source Code Files</span></h1>
<ul>
<li><em>source code file name #1 - summary for this source code file.</em> </li><li><em><em>source code file name #2 - summary for this source code file.</em></em>
</li></ul>
<h1>More Information</h1>
<p><em>For more information on X, see ...?</em></p>

</div>


    </div>
</body>
</html>
