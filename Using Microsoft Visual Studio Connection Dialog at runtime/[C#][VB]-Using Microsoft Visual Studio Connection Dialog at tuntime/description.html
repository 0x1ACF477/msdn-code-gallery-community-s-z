<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=E8541F983E4DC440B505A79DFC8DBB0D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=9D86FC63215962FC71C902C6C239D08F" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Using Microsoft Visual Studio Connection Dialog at tuntime</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Using Microsoft Visual Studio Connection Dialog at tuntime</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, SQL, SQL Server, Windows Forms, Data Access, Microsoft Visual Studio Connection Dialog
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            SQL Server, Data Access, Microsoft Visual Studio Connection Dialog
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">3/12/2017</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Description</h1>
<p><span style="font-size:small">In Visual Studio when a developer wants to create strong typed classes for database tables either for the conventional TableAdapter or Entity Framework there is a place in the process where a dialog is displayed as shown below.
 I will show you how to do this at runtime and a bit more.</span></p>
<p><img id="170914" src="description/Figure1.jpg" alt="" width="390" height="533"></p>
<p>&nbsp;</p>
<p><span style="font-size:small">This code sample will show you the basics of using this dialog by working with the source code. In the next screenshot I have modified the source code so that any time SQL-Server data provider is used and it's my login I get
 a context menu item that allows me to auto fill the Server Name.</span></p>
<p><img id="170915" src="description/Figure2.jpg" alt="" width="390" height="533"></p>
<p><span style="font-size:small">That is cool but we will now take advantage of this dialog so that (in this code sample) can create a SQL SELECT statement or create a CSV file for a table.</span></p>
<p><span style="font-size:small">To&nbsp;demonstrate this I created a simple windows forms project with the following interface to select a server, select a table, select columns. After making these selections pressing &quot;Generate SQL SELECT&quot; you get the following
 in the second image below.</span></p>
<p><span style="font-size:small"><img id="170916" src="description/Figure3.jpg" alt="" width="565" height="296"></span></p>
<p><span style="font-size:small">From Generate SQL SELECT (this logic can start you on other ideas with this simple example)</span></p>
<p><span style="font-size:small"><img id="170917" src="description/Figure4.jpg" alt="" width="389" height="152"></span></p>
<p>&nbsp;</p>
<p><span style="font-size:small">Pressing &quot;Export CSV&quot; takes the SQL SELECT statement and passes it off to a process which uses
<a href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://msdn.microsoft.com/en-us/library/ms162773.aspx?f=255&amp;MSPPError=-2147217396">
SQLCMD.EXE</a>. My Exporter class takes information obtained from the Connection Dialog and selections done in the form to create a CSV file.</span></p>
<p><span style="font-size:small"></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">using System;
using <a class="libraryLink" href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://msdn.microsoft.com/en-US/library/System.Diagnostics.aspx"  title="Auto generated link to System.Diagnostics">System.Diagnostics</a>;
using <a class="libraryLink" href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://msdn.microsoft.com/en-US/library/System.Linq.aspx"  title="Auto generated link to System.Linq">System.Linq</a>;

namespace WindowsFormsApplication1_cs
{
    public class Exporter
    {
        public void ToCsv(string ServerName, string DatabaseName, string SelectStatement, string FileName)
        {
            string DoubleQuote = ((char)(34)).ToString();
            string QueryToExceute = DoubleQuote &#43; SelectStatement &#43; DoubleQuote;
            string ExportFileName = DoubleQuote &#43; FileName &#43; DoubleQuote;

            var Process = new Process();
            
            Process.StartInfo.UseShellExecute = false;
            Process.StartInfo.RedirectStandardOutput = true;
            Process.StartInfo.RedirectStandardError = true;
            Process.StartInfo.CreateNoWindow = true;
            Process.StartInfo.FileName = &quot;SQLCMD.EXE&quot;;
            Process.StartInfo.Arguments = &quot;-S &quot; &#43; ServerName &#43; &quot; -d &quot; &#43; DatabaseName &#43; &quot; -E -Q &quot; &#43; 
                QueryToExceute &#43; &quot; -o &quot; &#43; ExportFileName &#43; &quot;  -h-1 -s\&quot;,\&quot; -w 700&quot;;
            Console.WriteLine($&quot;SQLCMD.EXE {Process.StartInfo.Arguments}&quot;);
            Process.Start();
            Process.WaitForExit();

            if (<a class="libraryLink" href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://msdn.microsoft.com/en-US/library/System.IO.File.Exists.aspx"  title="Auto generated link to System.IO.File.Exists">System.IO.File.Exists</a>(FileName))
            {
                var contents = <a class="libraryLink" href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://msdn.microsoft.com/en-US/library/System.IO.File.ReadAllLines.aspx"  title="Auto generated link to System.IO.File.ReadAllLines">System.IO.File.ReadAllLines</a>(FileName)
                    .Where(line =&gt; !line.ToLower().Contains(&quot;rows affected&quot;) &amp;&amp; !string.IsNullOrWhiteSpace(line)).ToArray();
                <a class="libraryLink" href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://msdn.microsoft.com/en-US/library/System.IO.File.WriteAllLines.aspx"  title="Auto generated link to System.IO.File.WriteAllLines">System.IO.File.WriteAllLines</a>(FileName, contents);
            }
        }
    }
}
</pre>
<div class="preview">
<pre class="js">using&nbsp;System;&nbsp;
using&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://msdn.microsoft.com/en-US/library/System.Diagnostics.aspx"  title="Auto generated link to System.Diagnostics">System.Diagnostics</a>;&nbsp;
using&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://msdn.microsoft.com/en-US/library/System.Linq.aspx"  title="Auto generated link to System.Linq">System.Linq</a>;&nbsp;
&nbsp;
namespace&nbsp;WindowsFormsApplication1_cs&nbsp;
<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;class&nbsp;Exporter&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;<span class="js__operator">void</span>&nbsp;ToCsv(string&nbsp;ServerName,&nbsp;string&nbsp;DatabaseName,&nbsp;string&nbsp;SelectStatement,&nbsp;string&nbsp;FileName)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;DoubleQuote&nbsp;=&nbsp;((char)(<span class="js__num">34</span>)).ToString();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;QueryToExceute&nbsp;=&nbsp;DoubleQuote&nbsp;&#43;&nbsp;SelectStatement&nbsp;&#43;&nbsp;DoubleQuote;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;ExportFileName&nbsp;=&nbsp;DoubleQuote&nbsp;&#43;&nbsp;FileName&nbsp;&#43;&nbsp;DoubleQuote;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;Process&nbsp;=&nbsp;<span class="js__operator">new</span>&nbsp;Process();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process.StartInfo.UseShellExecute&nbsp;=&nbsp;false;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process.StartInfo.RedirectStandardOutput&nbsp;=&nbsp;true;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process.StartInfo.RedirectStandardError&nbsp;=&nbsp;true;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process.StartInfo.CreateNoWindow&nbsp;=&nbsp;true;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process.StartInfo.FileName&nbsp;=&nbsp;<span class="js__string">&quot;SQLCMD.EXE&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process.StartInfo.Arguments&nbsp;=&nbsp;<span class="js__string">&quot;-S&nbsp;&quot;</span>&nbsp;&#43;&nbsp;ServerName&nbsp;&#43;&nbsp;<span class="js__string">&quot;&nbsp;-d&nbsp;&quot;</span>&nbsp;&#43;&nbsp;DatabaseName&nbsp;&#43;&nbsp;<span class="js__string">&quot;&nbsp;-E&nbsp;-Q&nbsp;&quot;</span>&nbsp;&#43;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QueryToExceute&nbsp;&#43;&nbsp;<span class="js__string">&quot;&nbsp;-o&nbsp;&quot;</span>&nbsp;&#43;&nbsp;ExportFileName&nbsp;&#43;&nbsp;<span class="js__string">&quot;&nbsp;&nbsp;-h-1&nbsp;-s\&quot;,\&quot;&nbsp;-w&nbsp;700&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine($<span class="js__string">&quot;SQLCMD.EXE&nbsp;{Process.StartInfo.Arguments}&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process.Start();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process.WaitForExit();&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">if</span>&nbsp;(<a class="libraryLink" href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://msdn.microsoft.com/en-US/library/System.IO.File.Exists.aspx"  title="Auto generated link to System.IO.File.Exists">System.IO.File.Exists</a>(FileName))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;contents&nbsp;=&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://msdn.microsoft.com/en-US/library/System.IO.File.ReadAllLines.aspx"  title="Auto generated link to System.IO.File.ReadAllLines">System.IO.File.ReadAllLines</a>(FileName)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Where(line&nbsp;=&gt;&nbsp;!line.ToLower().Contains(<span class="js__string">&quot;rows&nbsp;affected&quot;</span>)&nbsp;&amp;&amp;&nbsp;!string.IsNullOrWhiteSpace(line)).ToArray();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://msdn.microsoft.com/en-US/library/System.IO.File.WriteAllLines.aspx"  title="Auto generated link to System.IO.File.WriteAllLines">System.IO.File.WriteAllLines</a>(FileName,&nbsp;contents);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
<span class="js__brace">}</span>&nbsp;
</pre>
</div>
</div>
</div>
<div class="endscriptcode">The command for SQLCMD in this case is</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">SQLCMD.EXE -S KARENS-PC -d NorthWindAzure -E -Q &quot;SELECT [ProductID],[ProductName],[UnitsInStock] FROM Products&quot; -o &quot;C:\Dotnet\WindowsFormsApplication1_cs\bin\Debug\test.csv&quot; &nbsp;-h-1 -s&quot;,&quot; -w 700</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Partial contents of the file generate</div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><img id="170918" src="description/Figure5.jpg" alt="" width="581" height="105"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<h1 class="endscriptcode">How to use in your project</h1>
<div class="endscriptcode">Looking at the Visual Studio solution, the highlighted in yellow get compiled. Unload the projects in grey.</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Open your Visual Studio solution, add a reference to the DLL created in the solution above and now you can use them.</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">The project WindowsFormsApplication1_cs shows how to use the dialog and also how to do exporting.</div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><img id="170919" src="description/SampleProject.jpg" alt="" width="258" height="279"></div>
<h1 class="endscriptcode">IMPORTANT</h1>
<div class="endscriptcode">Things to watch out for concerning <a href="https://code.msdn.microsoft.com/Using-Visual-Studio-a7e740f8/https://msdn.microsoft.com/en-us/library/ms162773.aspx?f=255&amp;MSPPError=-2147217396">
SQLCMD.EXE</a>, if you attempt to create a export file and get error messages the common reason is that there is an authenication issue which you need to figure out the login and security which is outside the scope of this code sample.</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Note in Operations class, GetConnection that the optional parameter SaveConfiguration is false, setting it to true will create a xml file names DataConnections.xml which save the last data provider used and will be the default each
 time until you change it.</div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><img id="170920" src="description/43.jpg" alt="" width="593" height="682"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">The two things the connection dialog is good for is when writing code in development and also for when a user at runtime needs to select an alternate server. Needless to say there are many possibilities here.</div>
<div class="endscriptcode"></div>
<h1 class="endscriptcode">Copyrights</h1>
<div class="endscriptcode">As I did not create the classes for the Connection Dialog they are copyrighted to Microsoft as each class has a copyright notice within.</div>
</span>
<p></p>

</div>


    </div>
</body>
</html>
