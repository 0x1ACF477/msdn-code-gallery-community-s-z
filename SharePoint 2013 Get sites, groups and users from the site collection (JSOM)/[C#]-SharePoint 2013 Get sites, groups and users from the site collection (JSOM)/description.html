<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=23E9A5CBC52062E31AE45157B970504B" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=779C1C1BECDB79910DE087040C45EE9E" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>SharePoint 2013: Get sites, groups and users from the site collection (JSOM)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>SharePoint 2013: Get sites, groups and users from the site collection (JSOM)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            jQuery, Javascript, Sharepoint Online, SharePoint Server 2013, SharePoint Foundation 2013, apps for SharePoint, SharePoint Add-ins
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Data Binding, GridView, Cross Domain, JSOM
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web, Cloud, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">8/24/2016</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/SharePoint-2013-Get-sites-877ce290">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<p><span id="docs-internal-guid-8125fb6c-be3f-70ed-e433-dbc678a66217"></p>
<p dir="ltr"><span style="font-size:small"><strong>Summary</strong>: Learn how to use the cross-domain library in apps for SharePoint to get groups and users in a grid from an app web.</span></p>
<br>
<p dir="ltr"><span style="font-size:small"><strong>Last modified</strong>: 8/24/2016</span></p>
<br>
<p dir="ltr"><span style="font-size:small">This sample SharePoint hosted app demonstrates how to use the cross-domain library in SharePoint 2013 to get user groups and users list in the app web. The app deploys an grid to the app web, and displays the subsites,
 groups and users by using the JavaScript object model (JSOM).</span></p>
<h2 dir="ltr"><span style="font-size:small">Description of the sample</span></h2>
<p dir="ltr"><span style="font-size:small">The code that uses the cross-domain library and a third party grid control provided by
<a href="http://www.jqwidgets.com/jquery-widgets-documentation/documentation/introduction/introduction.htm">
jQWidgets</a>. The control used in this sample is a trial version. The grid displays all the subsite, user groups of each subsite and users of each group. Grid features like grouping, sorting and filtering are enabled in this app.
</span></p>
<br>
<p dir="ltr"><span style="font-size:small">Figure 1. Browser window display the grid grouped by Web and Group.</span></p>
<br>
<p dir="ltr"><span style="font-size:small"><img src="https://lh4.googleusercontent.com/a_l6_z1PnQEBKBeHhcWWc6Pc4OfANNkokot0hzaAaiOgk2bDFsBPnzLfeVKkzBF-tlQ2YFwpGdETw79G-6d0pTc3UXVy8WgFmlSYOzLd-SJ14uu5m09CXGI5Ht3SaDCRNQr0GRFD" alt="" width="602" height="299"></span></p>
<p dir="ltr"><span style="font-size:small"></span></p>
<h2 dir="ltr"><span style="font-size:small">Prerequisites</span></h2>
<p dir="ltr"><span style="font-size:small">This sample requires the following:</span></p>
<ul>
<li dir="ltr">
<p dir="ltr"><span style="font-size:small">Visual Studio 2015</span></p>
</li><li dir="ltr">
<p dir="ltr"><span style="font-size:small">Office Developer Tools for Visual Studio 2015</span></p>
</li><li dir="ltr">
<p dir="ltr"><span style="font-size:small">A SharePoint 2013 development environment</span></p>
</li></ul>
<br>
<p dir="ltr"><span style="font-size:small">For more information, see <a href="http://msdn.microsoft.com/library/jj163980.aspx">
Get started developing apps for SharePoint</a>.</span></p>
<h2 dir="ltr"><span style="font-size:small">Key components of the sample</span></h2>
<p dir="ltr"><span style="font-size:small">The sample contains the following:</span></p>
<ul>
<li dir="ltr">
<p dir="ltr"><span style="font-size:small">GetUserGroups project, which contains the AppManifest.xml file</span></p>
</li><li dir="ltr">
<p dir="ltr"><span style="font-size:small">GetUserGroups project</span></p>
<ul>
<li dir="ltr">
<p dir="ltr"><span style="font-size:small">Default.aspx file, which contains references to SharePoint JavaScript resource files</span></p>
</li><li dir="ltr">
<p dir="ltr"><span style="font-size:small">App.js file, which contains code to fetch data and display results</span></p>
</li><li dir="ltr">
<p dir="ltr"><span style="font-size:small">jQWidget folder, which contains all the required JavaScript files and images for grid control.</span></p>
</li></ul>
</li></ul>
<h2 dir="ltr"><span style="font-size:small">Configure the sample</span></h2>
<p dir="ltr"><span style="font-size:small">Follow these steps to configure the sample.</span></p>
<ul>
<li dir="ltr">
<p dir="ltr"><span style="font-size:small">Update the SiteUrl property of the solution with the URL of the home page of your SharePoint website.</span></p>
</li></ul>
<h2 dir="ltr"><span style="font-size:small">Run and test the sample</span></h2>
<p dir="ltr"><span style="font-size:small"></span></p>
<ol>
<li dir="ltr">
<p dir="ltr"><span style="font-size:small">Press F5 to build and deploy the app.</span></p>
</li><li dir="ltr">
<p dir="ltr"><span style="font-size:small">Choose Trust It on the consent page to grant permissions to the app.</span></p>
</li></ol>
<p dir="ltr"><span style="font-size:small">You should see an HTML page that displays five announcements.</span></p>
<h2 dir="ltr"><span style="font-size:small">Troubleshooting</span></h2>
<p dir="ltr"><span style="font-size:small">For troubleshooting steps, visit the <a href="http://msdn.microsoft.com/library/bc37ff5c-1285-40af-98ae-01286696242d# SP15Accessdatafromremoteapp_Troubleshoot">
Troubleshooting the solution</a> table in the cross-domain library documentation article.</span></p>
<h2 dir="ltr"><span style="font-size:small">Change log</span></h2>
<ul>
<li dir="ltr">
<p dir="ltr"><span style="font-size:small">First version: Aug 24, 2016</span></p>
</li></ul>
</span>
<p></p>
<h1></h1>

</div>


    </div>
</body>
</html>
