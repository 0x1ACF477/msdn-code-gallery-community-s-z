<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://uhf.microsoft.com/mscc/statics/mscc-0.4.0.min.css" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=C2D4A79D7E7BD7F156BC3B1988CF3EF3" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=76FE5B2D09416FA49EEA96DBF2EB4ED5" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>SOLID Web Parts with SharePoint Framework</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>SOLID Web Parts with SharePoint Framework</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Sharepoint Online
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Sharepoint Online, Sharepoint Web Parts, SOLID Principles
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Web
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">3/13/2018</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/SOLID-Web-Parts-with-8288d88a">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<p>The principles of SOLID are guidelines that can be applied to software development to improve legibility and maintainability of software applications. This article explores best practices and design patterns for developing SharePoint Web Parts in TypeScript,
 using the new client-side SharePoint Framework, and improving compliance to the five SOLID principles.</p>
<h1><br>
Being SOLID</h1>
<p>The term SOLID is a mnemonic acronym for five design principles intended to make software designs more understandable, flexible and maintainable:</p>
<p>&nbsp;</p>
<ol>
<li><strong>Single responsibility</strong>: An object should have only a single responsibility.
</li><li><strong>Open/closed</strong>: An object should be open for extension but closed for modification.
</li><li><strong>Liskov substitution</strong>: An object should be replaceable with instances of its subtype without altering the correct functioning of the software.
</li><li><strong>Interface segregation</strong>: When different behaviours are expected in an object, the object should implement many specific interfaces rather than one general-purpose interface.
</li><li><strong>Dependency inversion</strong>: An object should not have direct dependency on other concrete objects, but only on abstractions.
</li></ol>
<p>&nbsp;</p>
<p><br>
Typically, these software design principles are applied to large software development projects in order to guarantee a higher level of maintainability of the software, and loose object coupling, which encourages a microservice-oriented architecture. But nothing
 prevents us from being SOLID also in relatively smaller applications such as SharePoint web parts.</p>
<h1><br>
A not so SOLID web part</h1>
<p>By following the clearly described <a href="https://code.msdn.microsoft.com/SOLID-Web-Parts-with-8288d88a/https://docs.microsoft.com/en-us/sharepoint/dev/spfx/web-parts/get-started/build-a-hello-world-web-part" >
steps for building your first SharePoint client-side web part</a>, we can easily create a web part with the SharePoint Framework in a few minutes. However, let me tell you, this is just a very simple web part, far from being SOLID-compliant. Let&rsquo;s have
 a look at what the pitfalls are, or &ldquo;code smells&rdquo;, of such simple web part.</p>
<p>Let&rsquo;s assume we want to build a web part that shows some famous quotes, stored in a SharePoint custom list called &ldquo;Quotes&rdquo;, which contains a field for the Author and a field for the Quote itself. The first step, is to create a new folder
 and the run the Yeoman SharePoint Generator. Yeoman will install the required dependencies and it will scaffold the solution files along with the web part. We call this web part &ldquo;MyQuotes&rdquo; and we choose not to use any JavaScript framework for the
 purpose.</p>
<p><img id="192480" src="description/Fig1.png" alt="" width="952" height="318"></p>
<p><br>
A few minutes later, Yeoman is done. We can open the solution with VS Code (or any other TypeScript editor) and add the code for reading the quotes from a SharePoint list.</p>
<p>The <strong>MyQuotesWebPart.ts</strong> file in the src\webparts\myQuotes folder defines the main entry point for the web part. The
<strong>MyQuotesWebPart</strong> class extends the <strong>BaseClientSideWebPart</strong>. Any client-side web part should extend the BaseClientSideWebPart class to be defined as a valid web part, and this base class defines the minimal functionality that is
 required to build a web part with SPFx.</p>
<p>The <strong>render()</strong> method is used to render the web part inside a page, as part of its DOM (and not as an iframe, as it happens for traditional SharePoint add-ins). Here, in the render method, is where we want to make the necessary changes to
 display our famous quotes. We start by changing the title of the web part to &ldquo;Famous Quotes&rdquo;, and then adding a container with id = &ldquo;quotesContainer&rdquo; to use to fill with data coming from a SharePoint list. This &lt;div&gt; is populated
 by the method <strong>renderData()</strong>, invoked immediately after.</p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">public render(): void {
  this.domElement.innerHTML = `
    &lt;div class=&quot;${styles.myQuotes}&quot;&gt;
      &lt;div class=&quot;${styles.container}&quot;&gt;
        &lt;div class=&quot;ms-Grid-row ms-bgColor-themeDark ms-fontColor-white ${styles.row}&quot;&gt;
          &lt;div class=&quot;ms-Grid-col ms-lg10 ms-xl8 ms-xlPush2 ms-lgPush1&quot;&gt;
            &lt;span class=&quot;ms-font-xl ms-fontColor-white&quot;&gt;Famous Quotes&lt;/span&gt;
            &lt;div class=&quot;ms-font-l ms-fontColor-white&quot; id=&quot;quotesContainer&quot;&gt;&lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;`;

    this.renderData();
}
</pre>
<div class="preview">
<pre class="js">public&nbsp;render():&nbsp;<span class="js__operator">void</span>&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;<span class="js__operator">this</span>.domElement.innerHTML&nbsp;=&nbsp;`&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=<span class="js__string">&quot;${styles.myQuotes}&quot;</span>&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=<span class="js__string">&quot;${styles.container}&quot;</span>&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=<span class="js__string">&quot;ms-Grid-row&nbsp;ms-bgColor-themeDark&nbsp;ms-fontColor-white&nbsp;${styles.row}&quot;</span>&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=<span class="js__string">&quot;ms-Grid-col&nbsp;ms-lg10&nbsp;ms-xl8&nbsp;ms-xlPush2&nbsp;ms-lgPush1&quot;</span>&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=<span class="js__string">&quot;ms-font-xl&nbsp;ms-fontColor-white&quot;</span>&gt;Famous&nbsp;Quotes&lt;/span&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=<span class="js__string">&quot;ms-font-l&nbsp;ms-fontColor-white&quot;</span>&nbsp;id=<span class="js__string">&quot;quotesContainer&quot;</span>&gt;&lt;/div&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;`;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__operator">this</span>.renderData();&nbsp;
<span class="js__brace">}</span>&nbsp;
</pre>
</div>
</div>
</div>
<div class="endscriptcode"><em>(The code snippet is in TypeScript)</em></div>
<p>&nbsp;</p>
<h1>Local and live environments</h1>
<p><strong>SharePoint Workbench</strong> gives us the flexibility to test web parts in our local environment and from a SharePoint site. SharePoint Framework aids this capability by helping us understand which environment our web part is running from by using
 the <strong>Environment </strong>class. This is what renderData() does to differentiate between a local environment and an online environment. Depending on the environment type, two different methods are invoked:</p>
<ul>
<li><strong>getRealData()</strong> to retrieve list items from the SharePoint &ldquo;Quotes&rdquo; list using the helper class
<strong>spHttpClient </strong>to execute REST API requests against SharePoint. </li><li><strong>getMockData()</strong> to return sample quotes when testing our web part locally.
</li></ul>
<p>A third private method, <strong>renderQuotes()</strong> generates the HTML code for rendering a list of quotes. This is irrespective on the environment type, as data, either mock or real, is obtained before invoking this method.</p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">private renderData(): void {
  if (Environment.type === EnvironmentType.SharePoint || Environment.type === EnvironmentType.ClassicSharePoint) {
    this.getRealData().then((response) =&gt; {
      this.renderQuotes(response.value);
    });
  }
  else if (Environment.type === EnvironmentType.Local) {
    this.getMockData().then((response) =&gt; {
      this.renderQuotes(response.value);
    });
  }
}</pre>
<div class="preview">
<pre class="js">private&nbsp;renderData():&nbsp;<span class="js__operator">void</span>&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;<span class="js__statement">if</span>&nbsp;(Environment.type&nbsp;===&nbsp;EnvironmentType.SharePoint&nbsp;||&nbsp;Environment.type&nbsp;===&nbsp;EnvironmentType.ClassicSharePoint)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__operator">this</span>.getRealData().then((response)&nbsp;=&gt;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__operator">this</span>.renderQuotes(response.value);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>);&nbsp;
&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;<span class="js__statement">else</span>&nbsp;<span class="js__statement">if</span>&nbsp;(Environment.type&nbsp;===&nbsp;EnvironmentType.Local)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__operator">this</span>.getMockData().then((response)&nbsp;=&gt;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__operator">this</span>.renderQuotes(response.value);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>);&nbsp;
&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode"><em>(The code snippet is in TypeScript)</em></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1>Mocking data</h1>
<p>We need to define an interface that models the SharePoint list items that represent a quote. We actually need two interfaces:</p>
<ul>
<li><strong>IQuote</strong>, which defines the <strong>Author </strong>and <strong>
Quote </strong>fields that we want to display in the web part. This represents a single quote.
</li><li><strong>IQuotes</strong>, which represents a collection of quotes. </li></ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">export interface IQuotes {
  Quotes: IQuote[];
}

export interface IQuote {
  Author: string;
  Quote: string;
}</pre>
<div class="preview">
<pre class="js">export&nbsp;interface&nbsp;IQuotes&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;Quotes:&nbsp;IQuote[];&nbsp;
<span class="js__brace">}</span>&nbsp;
&nbsp;
export&nbsp;interface&nbsp;IQuote&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;Author:&nbsp;string;&nbsp;
&nbsp;&nbsp;Quote:&nbsp;string;&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode"><em>(The code snippet is in TypeScript)</em></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>To see sample quotes in the local Workbench, we need an object that returns mock data. We can define this object in a separate TypeScript file, say &ldquo;MockData.ts&rdquo;, and then reference this file in MyQuoteWebPart.ts.
<strong>MockData.ts</strong> itself refences (i.e. import in TypeScript) the IQuote interface defined in MyQuotesWebPart.</p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">import { IQuote } from './MyQuotesWebPart';

export default class MockData {

    private static _items: IQuote[] = [
        { Author: 'Author 1', Quote: 'Quote 1' },
        { Author: 'Author 2', Quote: 'Quote 2' },
        { Author: 'Author 3', Quote: 'Quote 3' }];

    public static get(): Promise&lt;IQuote[]&gt; {
        return new Promise&lt;IQuote[]&gt;((resolve) =&gt; {
           resolve(MockData._items);
       });
   }
}</pre>
<div class="preview">
<pre class="js">import&nbsp;<span class="js__brace">{</span>&nbsp;IQuote&nbsp;<span class="js__brace">}</span>&nbsp;from&nbsp;<span class="js__string">'./MyQuotesWebPart'</span>;&nbsp;
&nbsp;
export&nbsp;<span class="js__statement">default</span>&nbsp;class&nbsp;MockData&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;_items:&nbsp;IQuote[]&nbsp;=&nbsp;[&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;Author:&nbsp;<span class="js__string">'Author&nbsp;1'</span>,&nbsp;Quote:&nbsp;<span class="js__string">'Quote&nbsp;1'</span>&nbsp;<span class="js__brace">}</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;Author:&nbsp;<span class="js__string">'Author&nbsp;2'</span>,&nbsp;Quote:&nbsp;<span class="js__string">'Quote&nbsp;2'</span>&nbsp;<span class="js__brace">}</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">{</span>&nbsp;Author:&nbsp;<span class="js__string">'Author&nbsp;3'</span>,&nbsp;Quote:&nbsp;<span class="js__string">'Quote&nbsp;3'</span>&nbsp;<span class="js__brace">}</span>];&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;get():&nbsp;Promise&lt;IQuote[]&gt;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">return</span>&nbsp;<span class="js__operator">new</span>&nbsp;Promise&lt;IQuote[]&gt;((resolve)&nbsp;=&gt;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resolve(MockData._items);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>);&nbsp;
&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode"><em>(The code snippet is in TypeScript)</em></div>
<p>&nbsp;</p>
<p><br>
We can now use the <strong>MockData </strong>class in MyQuotesWebPart, after importing the MockData module.</p>
<pre>import MockData from './MockData';<br></pre>
<p>The <strong>getMockData()</strong> method returns a list of sample quotes defined in the MockData object.</p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">private getMockData(): Promise&lt;IQuotes&gt; {
  return MockData.get()
    .then((data: IQuote[]) =&gt; {
      var listData: IQuotes = { Quotes: data };
      return listData;
    }) as Promise&lt;IQuotes&gt;;
}</pre>
<div class="preview">
<pre class="js">private&nbsp;getMockData():&nbsp;Promise&lt;IQuotes&gt;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;<span class="js__statement">return</span>&nbsp;MockData.get()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;.then((data:&nbsp;IQuote[])&nbsp;=&gt;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">var</span>&nbsp;listData:&nbsp;IQuotes&nbsp;=&nbsp;<span class="js__brace">{</span>&nbsp;Quotes:&nbsp;data&nbsp;<span class="js__brace">}</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">return</span>&nbsp;listData;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>)&nbsp;as&nbsp;Promise&lt;IQuotes&gt;;&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode"><em>(The code snippet is in TypeScript)</em></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1>Displaying the web part</h1>
<p>Quotes are rendered in HTML and added to a container in the web part DOM by the
<strong>renderQuotes()</strong> method. This method loops the IQuote array and, for each item, defined the HTML code for showing a quote and its author.</p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">private renderQuotes(items: IQuote[]): void {
  let html: string = '';
  items.forEach((item: IQuote) =&gt; {
    html &#43;= `
      &lt;div&gt;${escape(item.Quote)}&lt;/div&gt;
      &lt;div class=&quot;${styles.author}&quot;&gt;${escape(item.Author)}&lt;/div&gt;  
    `;
  });

  const listContainer: Element = this.domElement.querySelector('#quotesContainer');
  listContainer.innerHTML = html;
}</pre>
<div class="preview">
<pre class="js">private&nbsp;renderQuotes(items:&nbsp;IQuote[]):&nbsp;<span class="js__operator">void</span>&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;let&nbsp;html:&nbsp;string&nbsp;=&nbsp;<span class="js__string">''</span>;&nbsp;
&nbsp;&nbsp;items.forEach((item:&nbsp;IQuote)&nbsp;=&gt;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;&#43;=&nbsp;`&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;$<span class="js__brace">{</span>escape(item.Quote)<span class="js__brace">}</span>&lt;/div&gt;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=<span class="js__string">&quot;${styles.author}&quot;</span>&gt;$<span class="js__brace">{</span>escape(item.Author)<span class="js__brace">}</span>&lt;/div&gt;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;`;&nbsp;
&nbsp;&nbsp;<span class="js__brace">}</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;<span class="js__statement">const</span>&nbsp;listContainer:&nbsp;Element&nbsp;=&nbsp;<span class="js__operator">this</span>.domElement.querySelector(<span class="js__string">'#quotesContainer'</span>);&nbsp;
&nbsp;&nbsp;listContainer.innerHTML&nbsp;=&nbsp;html;&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode"><em>(The code snippet is in TypeScript)</em></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>We can now open the local SharePoint Workbench with the &ldquo;gulp serve&rdquo; command and admire our web part in all its beauty!</p>
<p><img id="192481" src="description/Fig2.png" alt="" width="1199" height="379"></p>
<p>After deploying the web part to a SharePoint site, we can open the SharePoint Workbench hosted in SharePoint and see real quotes defined in the &ldquo;Quotes&rdquo; custom list.</p>
<h1><br>
The code smells</h1>
<p>So far so good, the web part works as expected, except it&rsquo;s not so good, really. At least, it&rsquo;s not SOLID good. These are the violations to the SOLID principles that I can identify for this web part:</p>
<ol>
<li><strong>No single responsibility</strong> in the MyQuotesWebPart. This class has methods for retrieving data, from both local and live environments, as well as displaying it. This should be done in two separate objects, one to read quotes from the SharePoint
 list, and the other one to write (display) quotes on screen. </li><li>The web part class is <strong>tightly coupled</strong> to the mock data object and the Quotes custom list. There is a direct dependency on these objects. If they don&rsquo;t exist, the web part won&rsquo;t work.
</li><li>The if condition on the environment type checking for local or SharePoint environment
<strong>prevents abstraction</strong> of the dependency (hard reference to spHttpClient to retrieve live data) and its replacement with a subtype, as a mock providing sample data should be.
</li></ol>
<p>In merit to the third point, basically providing mock data should not be a switch condition but an injection of a subtype of the real data object. So, it&rsquo;s time to refactor the web part to be more SOLID!</p>
<h1><br>
Refactoring to SOLID</h1>
<p>The first change to apply is a simple separation of files. Instead of adding the definition of the IQuote and IQuotes interfaces in the same TypeScript file where the web part object is defined, let&rsquo;s separate them into a
<strong>QuoteContracts.ts</strong> file. We&rsquo;ll also add a <strong>DataReader.ts</strong> file the contains the definition of the
<strong>IDataReader </strong>interface and <strong>DataReaderFactory</strong> class that we are going to use in the web part to abstract the dependency on the actual data store, and then the two implementations for reading quotes from the &ldquo;Quotes&rdquo;
 SharePoint custom list (<strong>SPDataReader.ts</strong>) and its subtype <strong>
MockDataReader </strong>(in <strong>MockDataReader.ts</strong>). The bad code of the web part is in the MyQuotesWebPart.BAD.ts file, just for comparison.</p>
<p><img id="192482" src="description/Fig3.png" alt="" width="385" height="439"></p>
<p>We now want to remove the hard-coded dependency to SharePoint data and mock data in the MyQuotes web part, controlled by the condition on the environment. Ideally, I would introduce an abstract data reader, and inject the dependency in the constructor of
 the web part. This would require an <strong>Inversion of Control container</strong>, but (a) I am not aware of any IoC library for TypeScript, specifically working with SPFx (feedback welcome here), and (b) it&rsquo;s an overkill solution for just a web part
 with one dependency.</p>
<p>I&rsquo;ll refactor the web part to use a more traditional abstract factory pattern, defined in the constructor. The web part defined a private data reader (<strong>IDataReader
</strong>type) and obtains a concrete instance from the data reader factory (<strong>DataReaderFactory
</strong>object) passing the current web part context.</p>
<p></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">export default class MyQuotesWebPart extends BaseClientSideWebPart&lt;IMyQuotesWebPartProps&gt; {

  constructor() {
    super();
    this._dataReader = DataReaderFactory.getReader(this.context);
  }

  private _dataReader : IDataReader;</pre>
<div class="preview">
<pre class="js">export&nbsp;<span class="js__statement">default</span>&nbsp;class&nbsp;MyQuotesWebPart&nbsp;extends&nbsp;BaseClientSideWebPart&lt;IMyQuotesWebPartProps&gt;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;
&nbsp;&nbsp;constructor()&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;super();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__operator">this</span>._dataReader&nbsp;=&nbsp;DataReaderFactory.getReader(<span class="js__operator">this</span>.context);&nbsp;
&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;
&nbsp;&nbsp;private&nbsp;_dataReader&nbsp;:&nbsp;IDataReader;</pre>
</div>
</div>
</div>
<div class="endscriptcode"><em>(The code snippet is in TypeScript)</em></div>
<p></p>
<p>The <strong>IDataReader </strong>interface simply defines a method <strong>getData()</strong> that returns
<strong>IQuotes</strong>, that is a collection of quotes. And the <strong>DataReaderFactory
</strong>object decides whether to return real data from SharePoint or mock data depending on the environment type.</p>
<p></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">export interface IDataReader {
    getData(): Promise&lt;IQuotes&gt;;
}

export class DataReaderFactory {
    public static getReader(context: IWebPartContext) {
        if (Environment.type === EnvironmentType.SharePoint || Environment.type === EnvironmentType.ClassicSharePoint) {
            return new SPDataReader(context, &quot;Quotes&quot;);
        }
        else if (Environment.type === EnvironmentType.Local) {
            return new MockDataReader();
        }
    }
}</pre>
<div class="preview">
<pre class="js">export&nbsp;interface&nbsp;IDataReader&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;getData():&nbsp;Promise&lt;IQuotes&gt;;&nbsp;
<span class="js__brace">}</span>&nbsp;
&nbsp;
export&nbsp;class&nbsp;DataReaderFactory&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;getReader(context:&nbsp;IWebPartContext)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">if</span>&nbsp;(Environment.type&nbsp;===&nbsp;EnvironmentType.SharePoint&nbsp;||&nbsp;Environment.type&nbsp;===&nbsp;EnvironmentType.ClassicSharePoint)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">return</span>&nbsp;<span class="js__operator">new</span>&nbsp;SPDataReader(context,&nbsp;<span class="js__string">&quot;Quotes&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">else</span>&nbsp;<span class="js__statement">if</span>&nbsp;(Environment.type&nbsp;===&nbsp;EnvironmentType.Local)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__statement">return</span>&nbsp;<span class="js__operator">new</span>&nbsp;MockDataReader();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span>&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode"><em>(The code snippet is in TypeScript)</em></div>
<p></p>
<p>This will make the <strong>renderData()</strong> method in MyQuotesWebPart very simple, without the differentiation on data source depending on the environment.</p>
<p></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">private renderData(): void {
  this._dataReader.getData().then((response) =&gt; {
    this.renderQuotes(response.Quotes);
  });
}</pre>
<div class="preview">
<pre class="js">private&nbsp;renderData():&nbsp;<span class="js__operator">void</span>&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;<span class="js__operator">this</span>._dataReader.getData().then((response)&nbsp;=&gt;&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__operator">this</span>.renderQuotes(response.Quotes);&nbsp;
&nbsp;&nbsp;<span class="js__brace">}</span>);&nbsp;
<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode"><em>(The code snippet is in TypeScript)</em></div>
<p></p>
<p>The actual data source is defined in the factory. The <strong>SPDataReader </strong>
class implements the <strong>IDataReader </strong>interface and, in the implemented
<strong>getData()</strong> method, utilizes the <strong>spHttpClient </strong>object, obtained by the web part context, to retrieve a list of items from the &ldquo;Quotes&rdquo; list. The dependency on the web part context and the name of the custom list is
 injected via its constructor.</p>
<p></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">export class SPDataReader implements IDataReader {
    constructor(context: IWebPartContext, listName: string) {
        this._context = context;
        this._listName = listName;
    }</pre>
<div class="preview">
<pre class="js">export&nbsp;class&nbsp;SPDataReader&nbsp;implements&nbsp;IDataReader&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;constructor(context:&nbsp;IWebPartContext,&nbsp;listName:&nbsp;string)&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__operator">this</span>._context&nbsp;=&nbsp;context;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__operator">this</span>._listName&nbsp;=&nbsp;listName;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode"><em>(The code snippet is in TypeScript)</em></div>
<p></p>
<p><br>
The <strong>MockDataReader </strong>object extends <strong>SPDataReader</strong>, and because sample data is hard-coded in the class itself, there is no need to specific any web part context or list name. Strictly speaking, there is no need to implement MockDataReader
 as a subtype of SPDataReader. MockDataReader can &ldquo;easily&rdquo; implement the IDataReader interface and be used interchangeably with SPDataReader. However, by subtyping MockDataReader from SPDataReader, we can prove the Liskov principle, which states
 that the functionality of the web part won&rsquo;t change if an object is replaced with an instance of its subtype.</p>
<p></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>JavaScript</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">js</span>
<pre class="hidden">export class MockDataReader extends SPDataReader {
    constructor() {
        super(null, null);
    }</pre>
<div class="preview">
<pre class="js">export&nbsp;class&nbsp;MockDataReader&nbsp;extends&nbsp;SPDataReader&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;constructor()&nbsp;<span class="js__brace">{</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(null,&nbsp;null);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="js__brace">}</span></pre>
</div>
</div>
</div>
<div class="endscriptcode"><em>(The code snippet is in TypeScript)</em></div>
<p></p>
<p>The entire solution is available on my Github repository for download: <a href="https://code.msdn.microsoft.com/SOLID-Web-Parts-with-8288d88a/https://github.com/stefanotempesta/SharePoint/myquotes-webpart" >
https://code.msdn.microsoft.com/SOLID-Web-Parts-with-8288d88a/https://github.com/stefanotempesta/SharePoint/myquotes-webpart</a></p>

</div>


    </div>
</body>
</html>
