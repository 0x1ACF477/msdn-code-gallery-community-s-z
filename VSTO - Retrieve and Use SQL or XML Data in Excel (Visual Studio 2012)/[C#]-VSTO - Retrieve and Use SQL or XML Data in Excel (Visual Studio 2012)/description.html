<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/1c1e217c-1475-400e-91a7-b2be1bd6efa0Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>VSTO - Retrieve and Use SQL or XML Data in Excel (Visual Studio 2012)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>VSTO - Retrieve and Use SQL or XML Data in Excel (Visual Studio 2012)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Microsoft Office Excel 2010, .NET Framework 4.0
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            SQL, Excel, VSTO, XML, Data Access
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">9/7/2012</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/VSTO-Retrieve-and-Use-SQL-9d11cc97">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p>This sample runs in Microsoft Office Excel 2010.</p>
<p>This sample demonstrates how to retrieve data from a relational database or XML file and use that data in Excel.</p>
<p>The sample is an order fulfillment worksheet. The worksheet displays details of customer orders so that the items can be packed for shipping. The worksheet also displays current inventory for each item so that the user knows if the order can be fulfilled.</p>
<h4>Security Note:</h4>
<p>This sample code is intended to illustrate a concept, and it shows only the code that is relevant to that concept. It may not meet the security requirements for a specific environment, and it should not be used exactly as shown. We recommend that you add
 security and error-handling code to make your projects more secure and robust. Microsoft provides this sample code &quot;AS IS&quot; with no warranties.</p>
<p>For information about installing the sample project on your computer, see How to: Install and Use Sample Files Found in Help.</p>
<h1><span>Building the Sample</span></h1>
<div class="subSection">
<ol>
<li>
<p>Press F5.</p>
</li><li>
<p>Select a customer name in the <span class="ui">Select a Customer</span> list.</p>
<p>The <span class="ui">Unfulfilled Orders</span> list is populated with the numbers of orders that have not been marked<span class="ui">Fulfilled</span>.</p>
</li><li>
<p>Select a number in the <span class="ui">Unfulfilled Orders</span> list.</p>
<p>The worksheet is populated with details from the order.</p>
</li><li>
<p>In the <span class="ui">Indicate Order Status</span> list, click <span class="ui">
Fulfilled</span>.</p>
<p>After the status is set to <span class="ui">Fulfilled</span>:</p>
<ul>
<li>
<p>The order status is saved back to the in-memory dataset.</p>
</li><li>
<p>The quantity ordered for each product in the order is subtracted from the <span class="ui">
UnitsInStock</span> element of that same product in the in-memory dataset. This ensures that the proper<span class="ui">UnitsInStock</span> value of each product is available for the next order.</p>
</li><li>
<p>The order is removed from the <span class="ui">Unfulfilled Orders</span> list.</p>
</li></ul>
</li></ol>
</div>
<h1>Description</h1>
<div class="section" id="demonstratesSection">
<p>This sample demonstrates how to:</p>
<ul>
<li>
<p>Retrieve and use data from an XML file that was extracted from a SQL Server database.</p>
</li><li>
<p>Display the data using data-bound Excel controls.</p>
</li><li>
<p>Work with multiple sets of master/detail data.</p>
</li></ul>
</div>
<h1>&nbsp;Sample Code</h1>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span><span class="hidden">vb</span>
<pre class="hidden">        /// &lt;summary&gt;  
        /// Ensures data is read in from data source so the sample will run properly.  
        /// &lt;/summary&gt;  
        private void LoadCompanyData()  
        {  
            Debug.Assert(this.currentCompanyData == null);  
            this.currentCompanyData = new CompanyData();  
            this.currentCompanyData.DataSetName = &quot;CompanyData&quot;;  
            this.currentCompanyData.Locale = new <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Globalization.CultureInfo.aspx"  title="Auto generated link to System.Globalization.CultureInfo">System.Globalization.CultureInfo</a>(&quot;en-US&quot;);  
            this.currentCompanyData.RemotingFormat = System.Data.SerializationFormat.Xml;  
  
            string fileLocation = <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.IO.Path.Combine.aspx"  title="Auto generated link to System.IO.Path.Combine">System.IO.Path.Combine</a>(this.Path,&quot;data.xml&quot;);  
            Debug.Assert(<a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.IO.File.Exists.aspx"  title="Auto generated link to System.IO.File.Exists">System.IO.File.Exists</a>(fileLocation),  
                String.Format(&quot;Sample data file {0} does not exist.&quot;, fileLocation));  
  
            this.currentCompanyData.ReadXml(fileLocation, XmlReadMode.IgnoreSchema);  
            this.currentCompanyData.AcceptChanges();  
        } </pre>
<pre class="hidden">    Private Sub LoadCompanyData()  
        Debug.Assert(Me.currentCompanyDataMember Is Nothing)  
        Me.currentCompanyDataMember = New CompanyData()  
        Me.currentCompanyDataMember.DataSetName = &quot;CompanyData&quot;  
        Me.currentCompanyDataMember.Locale = New <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Globalization.CultureInfo.aspx"  title="Auto generated link to System.Globalization.CultureInfo">System.Globalization.CultureInfo</a>(&quot;en-US&quot;)  
        Me.currentCompanyDataMember.RemotingFormat = System.Data.SerializationFormat.Xml  
  
        Dim fileLocation As String = <a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.IO.Path.Combine.aspx"  title="Auto generated link to System.IO.Path.Combine">System.IO.Path.Combine</a>(Me.Path, &quot;data.xml&quot;)  
        Debug.Assert(<a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.IO.File.Exists.aspx"  title="Auto generated link to System.IO.File.Exists">System.IO.File.Exists</a>(fileLocation), _  
            String.Format(&quot;Sample data file {0} does not exist.&quot;, fileLocation))  
  
        Me.currentCompanyDataMember.ReadXml(fileLocation)  
        Me.CurrentCompanyData.AcceptChanges()  
    End Sub </pre>
<div class="preview">
<pre class="csharp">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;summary&gt;&nbsp;&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;Ensures&nbsp;data&nbsp;is&nbsp;read&nbsp;in&nbsp;from&nbsp;data&nbsp;source&nbsp;so&nbsp;the&nbsp;sample&nbsp;will&nbsp;run&nbsp;properly.&nbsp;&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">///&nbsp;&lt;/summary&gt;&nbsp;&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">private</span>&nbsp;<span class="cs__keyword">void</span>&nbsp;LoadCompanyData()&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.Assert(<span class="cs__keyword">this</span>.currentCompanyData&nbsp;==&nbsp;<span class="cs__keyword">null</span>);&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">this</span>.currentCompanyData&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;CompanyData();&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">this</span>.currentCompanyData.DataSetName&nbsp;=&nbsp;<span class="cs__string">&quot;CompanyData&quot;</span>;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">this</span>.currentCompanyData.Locale&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;<a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.Globalization.CultureInfo.aspx"  title="Auto generated link to System.Globalization.CultureInfo">System.Globalization.CultureInfo</a>(<span class="cs__string">&quot;en-US&quot;</span>);&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">this</span>.currentCompanyData.RemotingFormat&nbsp;=&nbsp;System.Data.SerializationFormat.Xml;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;fileLocation&nbsp;=&nbsp;<a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.IO.Path.Combine.aspx"  title="Auto generated link to System.IO.Path.Combine">System.IO.Path.Combine</a>(<span class="cs__keyword">this</span>.Path,<span class="cs__string">&quot;data.xml&quot;</span>);&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.Assert(<a class="libraryLink" href="http://msdn.microsoft.com/en-US/library/System.IO.File.Exists.aspx"  title="Auto generated link to System.IO.File.Exists">System.IO.File.Exists</a>(fileLocation),&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.Format(<span class="cs__string">&quot;Sample&nbsp;data&nbsp;file&nbsp;{0}&nbsp;does&nbsp;not&nbsp;exist.&quot;</span>,&nbsp;fileLocation));&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">this</span>.currentCompanyData.ReadXml(fileLocation,&nbsp;XmlReadMode.IgnoreSchema);&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">this</span>.currentCompanyData.AcceptChanges();&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</pre>
</div>
</div>
</div>
<h1>More Information</h1>
<p>For more information about Office developer tools in Visual Studio, see <a href="http://msdn.microsoft.com/en-us/vsto/default.aspx">
http://msdn.microsoft.com/en-us/vsto/default.aspx</a>.</p>

</div>


    </div>
</body>
</html>
