<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://uhf.microsoft.com/mscc/statics/mscc-0.3.6.min.css" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=3C7B146E4D24AB77A9D9006DC4F48F98" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=1070D4FA49BFA3C2DA44B1CB75FED7A7" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Windows Form Validation (C#)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Windows Form Validation (C#)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, Validation, Windows Forms
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            C#, Windows Forms, Form validation, Windows controls
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">12/3/2017</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/Windows-Form-Validation-C-7d7e6045">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Description</h1>
<p><span style="font-size:small">This code sample provides code samples that will provide you with various choices to validate information entered by a user into Textbox and CombBox controls but the methods provided are not limited to these two controls, I
 wanted to keep things simple all around.</span></p>
<p><span style="font-size:small">From my time on various forums the average developer (thinking not with much experience) will do very little validation to confirm that information entered by the user is valid or no validation at all.</span></p>
<p><span style="font-size:small">Also these same developers believe that adding, editing data is best done in a DataGridView, perhaps from seeing this done within MS-Access. I can understand this yet with a little learning they can work adding and editing into
 a dialog form that displays over a form containing a DataGridView, add or edit and save back to the calling form.</span></p>
<p><span style="font-size:small">I&rsquo;ve done three examples, none of them load data from a file or database as I wanted to focus solely on validating data.</span></p>
<p><span style="font-size:small">In all three examples I validate that all TextBox controls are not empty and a ComboBox has a validate selection. Granted determining if all TextBox controls are populated can eat up many lines of code and really doesn&rsquo;t
 tell the user in most cases what is missing unless we add a Error Provider in which can be a ton of code if there are a lot of controls to validate as we must handle valid and invalid entries.</span></p>
<p><span style="font-size:small">In example one in project Sample1, this is all completely valid and would only do this type of validation on simple types (a few fields with simple validation). While example 2 I provide two alternatives. For the first we work
 with Validating event of the controls (same controls as in example 1), code must be written while the last method uses a component which was up on Code Project (see the read me file for details).</span></p>
<p><span style="font-size:small">Both code samples in Sample2 project are all valid and can see some developers leaning toward one or the other or heck, back to Sample1.</span></p>
<p><span style="font-size:small">Going with the last sample using a custom component, all you need to do is set it up e.g.</span></p>
<ol>
<li><span style="font-size:small">Drop it on the form.</span> </li><li><span style="font-size:small">Write two lines of code.</span> </li><li><span style="font-size:small">Setup each control via the property window.</span>
</li></ol>
<p><span style="font-size:small">Two lines of code</span></p>
<p><span style="font-size:x-small">&nbsp;</span></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">ValidationRule vr = new ValidationRule();
vr.CustomValidationMethod &#43;= vr_CustomValidationMethod;</pre>
<div class="preview">
<pre class="csharp">ValidationRule&nbsp;vr&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;ValidationRule();&nbsp;
vr.CustomValidationMethod&nbsp;&#43;=&nbsp;vr_CustomValidationMethod;</pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p>&nbsp;</p>
<p><span style="font-size:small">Setup in the property window.</span></p>
<p><span style="font-size:small"><img id="183067" src="description/1.jpg" alt="" width="382" height="106"></span></p>
<p><span style="font-size:small; color:#ffffff">.</span></p>
<p><span style="font-size:small">Rules once selecting the above.</span></p>
<p><span style="font-size:small; color:#ffffff">.</span></p>
<p><span style="font-size:small"><img id="183068" src="description/1C.jpg" alt="" width="537" height="521"><br>
</span></p>
<p><span style="font-size:small; color:#ffffff">.</span></p>
<p><span style="font-size:small">You can test a regular expression pattern e.g.</span></p>
<p><span style="font-size:small; color:#ffffff">.</span></p>
<p><span style="font-size:small"><img id="183069" src="description/2.jpg" alt="" width="510" height="410"></span></p>
<p><span style="font-size:small; color:#ffffff">.</span></p>
<p><span style="font-size:small">Although the special validator mentioned above makes life very easy to do validation does not mean that is how you should do validation. As mentioned above, some will go with the more basic method to validate information while
 others will go with one of the others. There are some people (perhaps hobbyist) who are not fluent enough to go with a more sophisticated method to validate, don&rsquo;t see the need while others don&rsquo;t care to use third party components. It&rsquo;s all
 up to you, I&rsquo;ve simply provided alternate methods that should make it easy to provide a basic to advance level of validation.&nbsp;</span></p>
<p><span style="font-size:small"><img id="183071" src="description/MD1.jpg" alt="" width="300" height="672"><br>
</span></p>
<p><span style="font-size:small"><br>
</span></p>

</div>


    </div>
</body>
</html>
