function TileShadow(){$(".Tile-Description").parent().mouseenter(function(){$(this).children(".Tile-Description").css("top","125px");$(this).children(".Tile-Description").animate({top:"-=125"},300)}).mouseleave(function(){$(this).children(".Tile-Description").css("top","0px");$(this).children(".Tile-Description").animate({top:"+=125"},300)});$(function(){$(".column").sortable({connectWith:".column",stop:function(){$(function(){var n=1;$(".tile").each(function(){var i=$(this),t=n+";#"+$(this).parent().attr("id");updateListItem($(this).attr("id"),t);n=n+1;$(this).width()===320&&$(this).parent().width(340);$(this).children().css("top","125px")})});SP.UI.Notify.addNotification("The Tiles are updated!",!1)}})})}function updateListItem(n,t){try{var i=new SP.ClientContext.get_current;oList=i.get_web().get_lists().getByTitle("Tiles");this.oListItem=oList.getItemById(n);oListItem.set_item("Order1",t);oListItem.update();i.executeQueryAsync(Function.createDelegate(this,this.onQueryitemSucceeded),Function.createDelegate(this,this.onQueryitemFailed))}catch(r){alert(r)}}function onQueryitemSucceeded(){}function onQueryFailed(n,t){SP.UI.Notify.addNotification("Request failed. "+t.get_message()+"\n"+t.get_stackTrace(),!0)}function retrieveListItems(){var n=new SP.ClientContext.get_current,i=n.get_web().get_lists().getByTitle("Tiles"),t=new SP.CamlQuery;t.set_viewXml("<View><Query><Where><Eq><FieldRef Name='Hide' /><Value Type='Boolean'>False<\/Value><\/Eq><\/Where><OrderBy><FieldRef Name='Order1'  Ascending='FALSE' /><\/OrderBy><\/Query><ViewFields><FieldRef Name='Id' /><FieldRef Name='Order1' /><FieldRef Name='Title' /><FieldRef Name='Description1' /><FieldRef Name='BackgroundImageLocation' /><FieldRef Name='LinkLocation' /><FieldRef Name='Color' /><FieldRef Name='LaunchBehavior' /><FieldRef Name='Size' /><FieldRef Name='Round' /><\/ViewFields><\/View>");this.collListItem=i.getItems(t);n.load(collListItem,"Include(Id, Title, Description1, BackgroundImageLocation, LinkLocation, Color, Size, LaunchBehavior, Order1,Round)");n.executeQueryAsync(Function.createDelegate(this,this.onQuerySucceeded),Function.createDelegate(this,this.onQueryFailed))}function getWebPropertiesSucceeded(){for(var i=webProperties.get_item("vti_TilesColumns"),t="",n=0;n<i;n++)t+='<div class="column" id="Col'+n+'"><\/div>';$("#TitleSettings").append(t);retrieveListItems()}function onQuerySucceeded(){for(var u=collListItem.getEnumerator();u.moveNext();){var n=u.get_current(),i="",e=n.get_item("Order1"),r=e.split(";#"),t="",f="";n.get_item("LaunchBehavior")==="Dialog"?(f='ShowDialogTile("'+n.get_item("LinkLocation").get_url()+'","'+n.get_item("Title")+'")',t="<a href='#' onclick='"+f+"'>"):t=n.get_item("LaunchBehavior")==="New Tab"?"<a href='"+n.get_item("LinkLocation").get_url()+"' target='_blank'>":"<a href='"+n.get_item("LinkLocation").get_url()+"'>";n.get_item("Size")==="BIG"?($("#"+r[1]).css("width","340px"),$("#"+r[1]).prepend("<div id='"+n.get_id()+"' class='"+i+" "+n.get_item("Color")+"' style='"+i+"width:320px;background-image:url("+encodeURI(n.get_item("BackgroundImageLocation").get_url())+");'><div class='Tile-Description' style='width:320px'>"+t+"<div style='float:left;width:50%;text-align:left;'>"+n.get_item("Title")+"<\/div><\/a><div style='float:right;width:50%;text-align:right'><a href='#' onclick='ShowDialog("+n.get_id()+")'  style='text-align:right;z-index:1000'><img src='../Images/EditOption.png' /><\/a><\/div>"+t+"<p>"+n.get_item("Description1")+"<\/p><\/a><\/div><\/div>")):$("#"+r[1]).prepend("<div id='"+n.get_id()+"' class='"+i+" "+n.get_item("Color")+"' style='"+i+"background-image:url("+encodeURI(n.get_item("BackgroundImageLocation").get_url())+");'><div class='Tile-Description'>"+t+"<div style='float:left;width:50%;text-align:left;'>"+n.get_item("Title")+"<\/div><\/a><div style='float:right;width:50%;text-align:right'><a href='#' onclick='ShowDialog("+n.get_id()+")'  style='text-align:right;z-index:1000'><img src='../Images/EditOption.png' /><\/a><\/div>"+t+"<p>"+n.get_item("Description1")+"<\/p><\/a><\/div><\/div>")}TileShadow()}function GetColumns(){var n=new SP.ClientContext.get_current;webProperties=n.get_web().get_allProperties();n.load(webProperties,"vti_TilesColumns");n.executeQueryAsync(Function.createDelegate(this,this.getWebPropertiesSucceeded),Function.createDelegate(this,this.onQueryFailed))}function ShowDialog(n){var t={url:"../Lists/Tiles/EditForm.aspx?ID="+n,allowMaximize:!0,title:"Edit Tile",dialogReturnValueCallback:scallback};return SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",t),!1}function scallback(n){n==SP.UI.DialogResult.OK&&SP.UI.ModalDialog.RefreshPage(SP.UI.DialogResult.OK)}function ShowDialogTile(n,t){var i={url:n,allowMaximize:!0,title:t};return SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",i),!1}function CallRibbon(){var t=SP.Ribbon.PageManager.get_instance(),n;t.add_ribbonInited(function(){TileTab()});n=null;try{n=t.get_ribbon()}catch(i){}n?TileTab():typeof _ribbonStartInit=="function"&&_ribbonStartInit(_ribbon.initialTabId,!1,null)}function TileTab(){var r="",u="",n,t,i;r+="<a href='../Lists/Tiles/' ><img src='../images/View.png' /><\/a><br/>Tiles View";u+="<a href='#' onclick='CallColumns();return false;'><img src='../Images/Columns32.png' /><\/a><br/>Manage Tiles Columns";n=SP.Ribbon.PageManager.get_instance().get_ribbon();n!==null&&(t=new CUI.Tab(n,"Tiles.Tab","Tiles","Use this tab to Manage Tiles","Tiles.Tab.Command",!1,"",null),n.addChildAtIndex(t,1),i=new CUI.Group(n,"Tiles.Tab.Group","Tiles View","Use this group to manage Tiles operations","Tiles.Group.Command",null),t.addChild(i),i=new CUI.Group(n,"Tiles.Tab.Group","Tiles Actions","Use this group to manage Tiles operations","Tiles.Group.Command",null),t.addChild(i));SelectRibbonTab("Tiles.Tab",!0);$("span:contains('Tiles View')").prev("span").html(r);$("span:contains('Tiles Actions')").prev("span").html(u);SelectRibbonTab("Ribbon.Read",!0)}function CallColumns(){var n={url:"../Pages/TilesColumns.aspx",allowMaximize:!0,title:"Manage Columns",dialogReturnValueCallback:scallback};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",n)}function scallback(n){SP.UI.ModalDialog.RefreshPage(n)}function getQueryStringParameter(n){for(var i,r=document.URL.split("?")[1].split("&"),t=0;t<r.length;t=t+1)if(i=r[t].split("="),i[0]==n)return i[1]}var appweburl=decodeURIComponent(getQueryStringParameter("SPAppWebUrl")),collListItem,webProperties;$(document).ready(function(){SP.SOD.executeFunc("sp.js","SP.ClientContext",GetColumns);SP.SOD.executeOrDelayUntilScriptLoaded(CallRibbon,"sp.ribbon.js")});
/*
//# sourceMappingURL=App.min.js.map
*/